# 扩展数据查询系统快速入门指南

## 简介

扩展数据查询系统是一个灵活、安全的数据查询平台，通过扩展机制允许开发者定制各种数据查询和处理功能。本指南将帮助您快速了解系统的基本使用方法和主要功能。

## 系统架构

系统采用模块化设计，主要包含以下几个部分：

1. **核心框架**：基于FastAPI的Web应用框架，提供路由、安全性和配置管理功能
2. **扩展管理**：负责加载、配置和管理各种查询扩展
3. **文件管理**：处理文件上传、存储和下载
4. **数据库支持**：使用SQLite数据库存储配置和元数据
5. **用户界面**：简洁直观的Web界面，方便操作和管理

## 快速开始

### 系统安装

1. 确保已安装Python 3.8+
2. 克隆代码仓库或解压系统压缩包
3. 安装依赖：`pip install -r requirements.txt`
4. 启动应用：`python main.py`

系统默认在`http://localhost:8000`运行，可以通过环境变量或配置文件修改。

### 主要功能

1. **扩展管理**
   - 访问`/config`页面配置和管理扩展
   - 启用、禁用、配置参数和查看扩展信息

2. **数据查询**
   - 在首页选择要使用的扩展
   - 填写查询参数并提交
   - 查看查询结果

3. **文件管理**
   - 访问`/file-manager`页面管理上传的文件
   - 上传、下载和删除文件

4. **示例和文档**
   - 在`/example`页面查看示例和文档
   - 学习如何开发自己的扩展

## 扩展开发

### 基本结构

创建扩展非常简单，只需要创建一个Python文件，包含以下基本结构：

```python
def get_config():
    """
    返回扩展的配置信息
    """
    return {
        "name": "示例扩展",
        "description": "这是一个示例扩展",
        "version": "1.0.0",
        "author": "您的姓名",
        "parameters": [
            {
                "name": "param1",
                "description": "参数1的描述",
                "type": "string",
                "required": True
            }
        ]
    }

def query(params):
    """
    执行查询逻辑，返回查询结果
    
    Args:
        params: 查询参数字典
        
    Returns:
        查询结果字典
    """
    # 获取参数
    param1 = params.get("param1")
    
    # 处理逻辑
    result = f"您输入的参数是: {param1}"
    
    # 返回结果
    return {
        "success": True,
        "data": result,
        "message": "查询成功"
    }
```

将此文件保存到`data/extensions`目录下，文件名为您的扩展ID，例如`my_extension.py`。

### 高级功能

扩展系统支持多种高级功能：

1. **文件上传处理**：
   - 在配置中定义文件字段
   - 通过`file_manager`安全处理上传的文件

2. **数据库访问**：
   - 使用`db`参数访问数据库
   - 安全地存储和检索数据

3. **异步处理**：
   - 定义异步查询函数处理耗时操作
   - 支持长时间运行的任务

有关更多详细信息，请参阅完整的[扩展开发指南](./EXTENSION_DEVELOPMENT_GUIDE.md)和[文件上传指南](./FILE_UPLOAD_GUIDE.md)。

## 安全注意事项

1. 扩展在沙箱环境中执行，有限制的导入和函数调用权限
2. 文件上传有大小和类型限制，确保系统安全
3. 扩展之间相互隔离，不能互相干扰
4. 所有API请求需要认证才能访问

## 常见问题

**问题**: 扩展无法加载或执行失败
**解答**: 检查语法错误，确保`get_config`和`query`函数正确定义，查看日志获取详细错误信息

**问题**: 文件上传失败
**解答**: 检查文件大小是否超过限制，确认文件类型是否被允许

**问题**: 参数配置不正确
**解答**: 参考参数设计文档，区分配置参数和查询参数的用法

## 获取帮助

如果您在使用过程中遇到任何问题，可以：

1. 查看系统日志文件（位于`data/logs`目录）
2. 参考文档和示例代码
3. 联系系统管理员获取支持

感谢您使用扩展数据查询系统！ 