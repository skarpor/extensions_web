2025-06-10 21:18:04,657 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:19:22,116 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:19:25,883 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:19:26,163 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 21:19:26,164 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 21:19:26,180 - main - INFO - 应用启动...
2025-06-10 21:19:26,181 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 21:19:26,181 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 21:19:26,182 - main - INFO - 应用启动完成
2025-06-10 21:19:35,406 - main - INFO - 应用关闭...
2025-06-10 21:19:37,230 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:19:37,487 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 21:19:37,487 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 21:19:37,496 - main - INFO - 应用启动...
2025-06-10 21:19:37,496 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 21:19:37,497 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 21:19:37,498 - main - INFO - 应用启动完成
2025-06-10 21:30:51,022 - main - INFO - 应用关闭...
2025-06-10 21:30:53,695 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:30:53,962 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 21:30:53,962 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 21:30:53,963 - main - INFO - 应用启动...
2025-06-10 21:30:53,964 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 21:30:53,964 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 21:30:53,964 - main - INFO - 应用启动完成
2025-06-10 21:31:04,769 - main - INFO - 应用关闭...
2025-06-10 21:31:06,762 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:31:07,041 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 21:31:07,042 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 21:31:07,043 - main - INFO - 应用启动...
2025-06-10 21:31:07,044 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 21:31:07,044 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 21:31:07,044 - main - INFO - 应用启动完成
2025-06-10 21:31:28,648 - main - INFO - 应用关闭...
2025-06-10 21:31:30,480 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:31:30,729 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 21:31:30,729 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 21:31:30,731 - main - INFO - 应用启动...
2025-06-10 21:31:30,731 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 21:31:30,732 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 21:31:30,732 - main - INFO - 应用启动完成
2025-06-10 21:31:42,710 - main - INFO - 应用关闭...
2025-06-10 21:31:44,516 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:31:54,114 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:32:02,708 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:32:23,223 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:32:47,539 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:40:13,988 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:40:56,724 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:40:57,041 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 21:40:57,041 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 21:40:57,041 - main - INFO - 应用启动...
2025-06-10 21:40:57,041 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 21:40:57,041 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 21:40:57,041 - main - INFO - 应用启动完成
2025-06-10 21:43:52,069 - main - INFO - 应用关闭...
2025-06-10 21:43:53,995 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:43:54,339 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 21:43:54,340 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 21:43:54,345 - main - INFO - 应用启动...
2025-06-10 21:43:54,346 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 21:43:54,346 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 21:43:54,347 - main - INFO - 应用启动完成
2025-06-10 21:47:18,009 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:47:18,408 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 21:47:18,409 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 21:47:18,410 - main - INFO - 应用启动...
2025-06-10 21:47:18,410 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 21:47:18,410 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 21:47:18,410 - main - INFO - 应用启动完成
2025-06-10 21:49:12,000 - main - INFO - 应用关闭...
2025-06-10 21:49:14,675 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:49:14,987 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 21:49:14,987 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 21:49:14,988 - main - INFO - 应用启动...
2025-06-10 21:49:14,988 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 21:49:14,988 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 21:49:14,988 - main - INFO - 应用启动完成
2025-06-10 21:49:24,423 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:49:24,769 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 21:49:24,770 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 21:49:24,771 - main - INFO - 应用启动...
2025-06-10 21:49:24,771 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 21:49:24,771 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 21:49:24,771 - main - INFO - 应用启动完成
2025-06-10 21:51:12,709 - main - INFO - 应用关闭...
2025-06-10 21:51:17,963 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:51:18,231 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 21:51:18,232 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 21:51:18,233 - main - INFO - 应用启动...
2025-06-10 21:51:18,233 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 21:51:18,233 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 21:51:18,233 - main - INFO - 应用启动完成
2025-06-10 21:51:19,522 - auth - INFO - 用户尝试登录: admin
2025-06-10 21:51:19,522 - auth - ERROR - 用户登录过程中发生错误: 'coroutine' object is not subscriptable
2025-06-10 21:52:37,593 - auth - INFO - 用户尝试登录: admin
2025-06-10 21:52:37,594 - auth - ERROR - 用户登录过程中发生错误: 'coroutine' object is not subscriptable
2025-06-10 21:53:17,505 - auth - INFO - 用户尝试登录: admin
2025-06-10 21:53:17,506 - auth - ERROR - 用户登录过程中发生错误: 'coroutine' object is not subscriptable
2025-06-10 21:53:25,509 - main - INFO - 应用关闭...
2025-06-10 21:53:31,687 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:53:31,984 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 21:53:31,985 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 21:53:31,985 - main - INFO - 应用启动...
2025-06-10 21:53:31,986 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 21:53:31,986 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 21:53:31,986 - main - INFO - 应用启动完成
2025-06-10 21:53:32,531 - auth - INFO - 用户尝试登录: admin
2025-06-10 21:53:32,546 - auth - ERROR - 用户登录过程中发生错误: back_populates on relationship 'Setting.user' refers to attribute 'User.settings' that is not a relationship.  The back_populates parameter should refer to the name of a relationship on the target class.
2025-06-10 21:55:07,565 - main - INFO - 应用关闭...
2025-06-10 21:55:10,087 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:55:10,388 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 21:55:10,388 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 21:55:10,389 - main - INFO - 应用启动...
2025-06-10 21:55:10,389 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 21:55:10,389 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 21:55:10,389 - main - INFO - 应用启动完成
2025-06-10 21:55:13,992 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:55:14,329 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 21:55:14,329 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 21:55:14,330 - main - INFO - 应用启动...
2025-06-10 21:55:14,330 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 21:55:14,330 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 21:55:14,330 - main - INFO - 应用启动完成
2025-06-10 21:55:17,749 - auth - INFO - 用户尝试登录: admin
2025-06-10 21:55:17,773 - auth - ERROR - 用户登录过程中发生错误: (sqlite3.OperationalError) no such column: users.full_name
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.full_name, users.is_active, users.is_superuser, users.roles, users.permissions, users.created_at, users.updated_at, users.settings, users.config 
FROM users 
WHERE users.username = ?]
[parameters: ('admin',)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-10 21:57:13,856 - auth - INFO - 用户尝试登录: admin
2025-06-10 21:57:13,866 - auth - ERROR - 用户登录过程中发生错误: (sqlite3.OperationalError) no such column: users.full_name
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.full_name, users.is_active, users.is_superuser, users.roles, users.permissions, users.created_at, users.updated_at, users.settings, users.config 
FROM users 
WHERE users.username = ?]
[parameters: ('admin',)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-10 21:57:14,024 - main - INFO - 应用关闭...
2025-06-10 21:57:16,602 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:57:16,923 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 21:57:16,924 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 21:57:16,925 - main - INFO - 应用启动...
2025-06-10 21:57:16,925 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 21:57:16,926 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 21:57:16,926 - main - INFO - 应用启动完成
2025-06-10 21:57:16,933 - auth - INFO - 用户尝试登录: admin
2025-06-10 21:57:16,963 - auth - ERROR - 用户登录过程中发生错误: (sqlite3.OperationalError) no such column: users.full_name
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.full_name, users.is_active, users.is_superuser, users.roles, users.permissions, users.created_at, users.updated_at, users.settings, users.config 
FROM users 
WHERE users.username = ?]
[parameters: ('admin',)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-10 21:58:58,766 - main - INFO - 应用关闭...
2025-06-10 21:59:02,796 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 21:59:03,095 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 21:59:03,096 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 21:59:03,097 - main - INFO - 应用启动...
2025-06-10 21:59:03,097 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 21:59:03,097 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 21:59:03,097 - main - INFO - 应用启动完成
2025-06-10 21:59:11,533 - auth - INFO - 用户尝试登录: admin
2025-06-10 21:59:11,577 - auth - ERROR - 用户登录过程中发生错误: (sqlite3.OperationalError) no such column: users.full_name
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.full_name, users.is_active, users.is_superuser, users.roles, users.permissions, users.created_at, users.updated_at, users.settings, users.config 
FROM users 
WHERE users.username = ?]
[parameters: ('admin',)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-10 22:02:26,781 - auth - INFO - 用户尝试登录: admin
2025-06-10 22:02:26,793 - auth - ERROR - 用户登录过程中发生错误: (sqlite3.OperationalError) no such column: users.full_name
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.full_name, users.is_active, users.is_superuser, users.roles, users.permissions, users.created_at, users.updated_at, users.settings, users.config 
FROM users 
WHERE users.username = ?]
[parameters: ('admin',)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-10 22:02:26,968 - main - INFO - 应用关闭...
2025-06-10 22:02:29,517 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 22:02:29,823 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 22:02:29,824 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 22:02:29,825 - main - INFO - 应用启动...
2025-06-10 22:02:29,825 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 22:02:29,825 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 22:02:29,825 - main - INFO - 应用启动完成
2025-06-10 22:02:36,308 - auth - INFO - 用户尝试登录: admin
2025-06-10 22:02:36,343 - auth - ERROR - 用户登录过程中发生错误: (sqlite3.OperationalError) no such column: users.roles
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.is_active, users.roles, users.permissions, users.created_at, users.updated_at, users.settings, users.config 
FROM users 
WHERE users.username = ?]
[parameters: ('admin',)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-10 22:04:29,001 - main - INFO - 应用关闭...
2025-06-10 22:04:31,583 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 22:04:31,867 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 22:04:31,868 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 22:04:31,869 - main - INFO - 应用启动...
2025-06-10 22:04:31,869 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 22:04:31,869 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 22:04:31,869 - main - INFO - 应用启动完成
2025-06-10 22:04:39,000 - auth - INFO - 用户尝试登录: admin
2025-06-10 22:04:39,019 - auth - ERROR - 用户登录过程中发生错误: Mapper 'Mapper[User(users)]' has no property 'files'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-10 22:05:01,741 - main - INFO - 应用关闭...
2025-06-10 22:05:04,102 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 22:05:04,449 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 22:05:04,450 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 22:05:04,451 - main - INFO - 应用启动...
2025-06-10 22:05:04,451 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 22:05:04,451 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 22:05:04,451 - main - INFO - 应用启动完成
2025-06-10 22:06:09,423 - auth - INFO - 用户尝试登录: admin
2025-06-10 22:06:09,441 - auth - ERROR - 用户登录过程中发生错误: Mapper 'Mapper[User(users)]' has no property 'files'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-10 22:07:48,408 - auth - INFO - 用户尝试登录: admin
2025-06-10 22:07:48,416 - auth - ERROR - 用户登录过程中发生错误: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[File(files)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'files'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-10 22:07:48,605 - main - INFO - 应用关闭...
2025-06-10 22:07:51,121 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 22:07:51,422 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 22:07:51,422 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 22:07:51,423 - main - INFO - 应用启动...
2025-06-10 22:07:51,423 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 22:07:51,423 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 22:07:51,423 - main - INFO - 应用启动完成
2025-06-10 22:07:51,429 - auth - INFO - 用户尝试登录: admin
2025-06-10 22:07:51,437 - auth - ERROR - 用户登录过程中发生错误: Mapper 'Mapper[User(users)]' has no property 'files'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-10 22:07:53,029 - auth - INFO - 用户尝试登录: admin
2025-06-10 22:07:53,032 - auth - ERROR - 用户登录过程中发生错误: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[File(files)]'. Original exception was: Mapper 'Mapper[User(users)]' has no property 'files'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-10 22:08:52,085 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-10 22:08:52,388 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-10 22:08:52,389 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-10 22:08:52,389 - main - INFO - 应用启动...
2025-06-10 22:08:52,389 - extension_manager - INFO - 开始加载所有扩展
2025-06-10 22:08:52,390 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-10 22:08:52,390 - main - INFO - 应用启动完成
2025-06-10 22:09:06,570 - main - INFO - 应用关闭...
2025-06-11 10:43:31,869 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 10:43:54,757 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 10:43:55,208 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 10:43:55,209 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 10:43:55,269 - main - INFO - 应用启动...
2025-06-11 10:43:55,269 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 10:43:55,269 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 10:43:55,269 - main - INFO - 应用启动完成
2025-06-11 10:47:21,621 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 10:47:21,819 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 10:47:21,820 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 10:47:21,821 - main - INFO - 应用启动...
2025-06-11 10:47:21,821 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 10:47:21,821 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 10:47:21,821 - main - INFO - 应用启动完成
2025-06-11 10:48:48,703 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 10:48:48,913 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 10:48:48,913 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 10:48:48,914 - main - INFO - 应用启动...
2025-06-11 10:48:48,914 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 10:48:48,915 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 10:48:48,915 - main - INFO - 应用启动完成
2025-06-11 10:49:42,714 - main - ERROR - 全局异常: Mapper 'Mapper[User(users)]' has no property 'files'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\mapper.py", line 2491, in get_property
    return self._props[key]
KeyError: 'files'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 237, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 163, in run_endpoint_function
    return await dependant.call(**values)
  File "E:\projects\d08\extensions_web\new_app\api\v1\endpoints\auth.py", line 27, in login
    user = await auth.authenticate(
  File "E:\projects\d08\extensions_web\new_app\core\auth.py", line 196, in authenticate
    user = await db.execute(select(User).where(User.username == username))
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 313, in execute
    result = await greenlet_spawn(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 167, in greenlet_spawn
    result = context.switch(value)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\session.py", line 2229, in execute
    return self._execute_internal(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\session.py", line 2124, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\context.py", line 252, in orm_execute_statement
    result = conn.execute(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\engine\base.py", line 1414, in execute
    return meth(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\sql\elements.py", line 485, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\engine\base.py", line 1630, in _execute_clauseelement
    compiled_sql, extracted_params, cache_hit = elem._compile_w_cache(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\sql\elements.py", line 651, in _compile_w_cache
    compiled_sql = self._compiler(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\sql\elements.py", line 290, in _compiler
    return dialect.statement_compiler(dialect, self, **kw)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\sql\compiler.py", line 1269, in __init__
    Compiled.__init__(self, dialect, statement, **kwargs)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\sql\compiler.py", line 710, in __init__
    self.string = self.process(self.statement, **compile_kwargs)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\sql\compiler.py", line 755, in process
    return obj._compiler_dispatch(self, **kwargs)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\sql\visitors.py", line 143, in _compiler_dispatch
    return meth(self, **kw)  # type: ignore  # noqa: E501
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\sql\compiler.py", line 4406, in visit_select
    compile_state = select_stmt._compile_state_factory(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\sql\base.py", line 650, in create_for_statement
    return klass.create_for_statement(statement, compiler, **kw)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\context.py", line 987, in create_for_statement
    _QueryEntity.to_compile_state(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\context.py", line 2430, in to_compile_state
    _MapperEntity(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\context.py", line 2510, in __init__
    entity._post_inspect
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\util\langhelpers.py", line 1254, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\mapper.py", line 2693, in _post_inspect
    self._check_configure()
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\mapper.py", line 2374, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\mapper.py", line 4116, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\mapper.py", line 4158, in _do_configure_registries
    mapper._post_configure_properties()
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\mapper.py", line 2391, in _post_configure_properties
    prop.init()
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\interfaces.py", line 544, in init
    self.do_init()
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\relationships.py", line 1637, in do_init
    self._generate_backref()
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\relationships.py", line 2128, in _generate_backref
    self._add_reverse_property(self.back_populates)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\relationships.py", line 1569, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\mapper.py", line 2493, in get_property
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[User(users)]' has no property 'files'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-06-11 10:54:20,943 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 10:54:21,148 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 10:54:21,149 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 10:54:21,150 - main - INFO - 应用启动...
2025-06-11 10:54:21,150 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 10:54:21,150 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 10:54:21,151 - main - INFO - 应用启动完成
2025-06-11 10:54:36,356 - main - ERROR - 全局异常: 'ChunkedIteratorResult' object has no attribute 'hashed_password'
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 237, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 163, in run_endpoint_function
    return await dependant.call(**values)
  File "E:\projects\d08\extensions_web\new_app\api\v1\endpoints\auth.py", line 27, in login
    user = await auth.authenticate(
  File "E:\projects\d08\extensions_web\new_app\core\auth.py", line 199, in authenticate
    if not verify_password(password, user.hashed_password):
AttributeError: 'ChunkedIteratorResult' object has no attribute 'hashed_password'
2025-06-11 10:56:21,414 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 10:56:21,614 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 10:56:21,615 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 10:56:21,616 - main - INFO - 应用启动...
2025-06-11 10:56:21,616 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 10:56:21,616 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 10:56:21,616 - main - INFO - 应用启动完成
2025-06-11 10:56:24,809 - main - ERROR - 全局异常: 'coroutine' object has no attribute 'one_or_none'
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 237, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 163, in run_endpoint_function
    return await dependant.call(**values)
  File "E:\projects\d08\extensions_web\new_app\api\v1\endpoints\auth.py", line 27, in login
    user = await auth.authenticate(
  File "E:\projects\d08\extensions_web\new_app\core\auth.py", line 196, in authenticate
    user = await db.execute(select(User).where(User.username == username)).one_or_none()
AttributeError: 'coroutine' object has no attribute 'one_or_none'
2025-06-11 10:56:37,087 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 10:56:37,286 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 10:56:37,286 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 10:56:37,287 - main - INFO - 应用启动...
2025-06-11 10:56:37,287 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 10:56:37,287 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 10:56:37,287 - main - INFO - 应用启动完成
2025-06-11 10:56:50,753 - main - ERROR - 全局异常: tuple indices must be integers or slices, not str
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 237, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 163, in run_endpoint_function
    return await dependant.call(**values)
  File "E:\projects\d08\extensions_web\new_app\api\v1\endpoints\auth.py", line 27, in login
    user = await auth.authenticate(
  File "E:\projects\d08\extensions_web\new_app\core\auth.py", line 200, in authenticate
    if not verify_password(password, user['hashed_password']):
  File "lib\sqlalchemy\cyextension\resultproxy.pyx", line 67, in sqlalchemy.cyextension.resultproxy.BaseRow.__getitem__
TypeError: tuple indices must be integers or slices, not str
2025-06-11 10:57:20,231 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 10:57:20,433 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 10:57:20,434 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 10:57:20,434 - main - INFO - 应用启动...
2025-06-11 10:57:20,435 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 10:57:20,435 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 10:57:20,435 - main - INFO - 应用启动完成
2025-06-11 10:57:30,222 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 10:57:30,420 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 10:57:30,421 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 10:57:30,421 - main - INFO - 应用启动...
2025-06-11 10:57:30,422 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 10:57:30,422 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 10:57:30,422 - main - INFO - 应用启动完成
2025-06-11 10:57:31,739 - main - ERROR - 全局异常: 'User' object is not subscriptable
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 237, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 163, in run_endpoint_function
    return await dependant.call(**values)
  File "E:\projects\d08\extensions_web\new_app\api\v1\endpoints\auth.py", line 27, in login
    user = await auth.authenticate(
  File "E:\projects\d08\extensions_web\new_app\core\auth.py", line 201, in authenticate
    if not verify_password(password, user['hashed_password']):
TypeError: 'User' object is not subscriptable
2025-06-11 10:58:11,611 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 10:58:11,820 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 10:58:11,821 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 10:58:11,822 - main - INFO - 应用启动...
2025-06-11 10:58:11,822 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 10:58:11,822 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 10:58:11,822 - main - INFO - 应用启动完成
2025-06-11 10:58:13,550 - main - ERROR - 全局异常: 'User' object has no attribute 'scalars'
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 237, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 163, in run_endpoint_function
    return await dependant.call(**values)
  File "E:\projects\d08\extensions_web\new_app\api\v1\endpoints\auth.py", line 27, in login
    user = await auth.authenticate(
  File "E:\projects\d08\extensions_web\new_app\core\auth.py", line 203, in authenticate
    return user.scalars().one()
AttributeError: 'User' object has no attribute 'scalars'
2025-06-11 10:59:00,168 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 10:59:00,367 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 10:59:00,368 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 10:59:00,369 - main - INFO - 应用启动...
2025-06-11 10:59:00,369 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 10:59:00,369 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 10:59:00,369 - main - INFO - 应用启动完成
2025-06-11 10:59:30,294 - main - INFO - 应用关闭...
2025-06-11 10:59:33,769 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 10:59:33,987 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 10:59:33,988 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 10:59:33,989 - main - INFO - 应用启动...
2025-06-11 10:59:33,989 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 10:59:33,989 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 10:59:33,989 - main - INFO - 应用启动完成
2025-06-11 11:03:05,644 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 11:03:05,957 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 11:03:05,957 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 11:03:05,958 - main - INFO - 应用启动...
2025-06-11 11:03:05,958 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 11:03:05,958 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 11:03:05,958 - main - INFO - 应用启动完成
2025-06-11 11:03:12,904 - auth - INFO - 用户尝试登录: admin
2025-06-11 11:03:13,314 - auth - ERROR - 用户登录过程中发生错误: 'User' object is not subscriptable
2025-06-11 11:05:52,086 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 11:05:52,285 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 11:05:52,286 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 11:05:52,287 - main - INFO - 应用启动...
2025-06-11 11:05:52,287 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 11:05:52,287 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 11:05:52,287 - main - INFO - 应用启动完成
2025-06-11 11:05:54,649 - auth - INFO - 用户尝试登录: admin
2025-06-11 11:05:54,976 - auth - INFO - 用户登录成功: admin
2025-06-11 11:05:54,976 - auth - ERROR - 用户登录过程中发生错误: 'User' object is not subscriptable
2025-06-11 11:06:05,533 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 11:06:05,732 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 11:06:05,732 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 11:06:05,733 - main - INFO - 应用启动...
2025-06-11 11:06:05,733 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 11:06:05,733 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 11:06:05,734 - main - INFO - 应用启动完成
2025-06-11 11:06:07,536 - auth - INFO - 用户尝试登录: admin
2025-06-11 11:06:07,815 - auth - INFO - 用户登录成功: admin
2025-06-11 11:06:07,817 - main - ERROR - 全局异常: 'User' object is not subscriptable
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 237, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 163, in run_endpoint_function
    return await dependant.call(**values)
  File "E:\projects\d08\extensions_web\new_app\api\v1\endpoints\auth.py", line 112, in login_for_token
    "username": user["username"],
TypeError: 'User' object is not subscriptable
2025-06-11 11:08:24,269 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 11:08:24,479 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 11:08:24,479 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 11:08:24,480 - main - INFO - 应用启动...
2025-06-11 11:08:24,480 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 11:08:24,480 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 11:08:24,481 - main - INFO - 应用启动完成
2025-06-11 11:08:26,337 - auth - INFO - 用户尝试登录: admin
2025-06-11 11:08:26,614 - auth - INFO - 用户登录成功: admin
2025-06-11 11:08:26,615 - main - ERROR - 全局异常: 'User' object has no attribute 'role'
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 237, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 163, in run_endpoint_function
    return await dependant.call(**values)
  File "E:\projects\d08\extensions_web\new_app\api\v1\endpoints\auth.py", line 113, in login_for_token
    "role": user.role,
AttributeError: 'User' object has no attribute 'role'
2025-06-11 11:08:50,311 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 11:08:50,514 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 11:08:50,515 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 11:08:50,516 - main - INFO - 应用启动...
2025-06-11 11:08:50,516 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 11:08:50,516 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 11:08:50,516 - main - INFO - 应用启动完成
2025-06-11 11:08:51,847 - auth - INFO - 用户尝试登录: admin
2025-06-11 11:08:52,121 - auth - INFO - 用户登录成功: admin
2025-06-11 11:08:52,123 - main - ERROR - 全局异常: 'User' object is not subscriptable
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 237, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 163, in run_endpoint_function
    return await dependant.call(**values)
  File "E:\projects\d08\extensions_web\new_app\api\v1\endpoints\auth.py", line 113, in login_for_token
    "role": user['role'],
TypeError: 'User' object is not subscriptable
2025-06-11 11:13:49,053 - main - INFO - 应用关闭...
2025-06-11 11:13:50,442 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 11:13:50,640 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 11:13:50,641 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 11:13:50,642 - main - INFO - 应用启动...
2025-06-11 11:13:50,642 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 11:13:50,642 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 11:13:50,642 - main - INFO - 应用启动完成
2025-06-11 11:31:51,933 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 11:31:52,136 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 11:31:52,137 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 11:31:52,138 - main - INFO - 应用启动...
2025-06-11 11:31:52,138 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 11:31:52,138 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 11:31:52,138 - main - INFO - 应用启动完成
2025-06-11 11:33:02,494 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 11:33:04,906 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 11:33:04,907 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 11:33:04,908 - main - INFO - 应用启动...
2025-06-11 11:33:04,908 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 11:33:04,908 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 11:33:04,908 - main - INFO - 应用启动完成
2025-06-11 11:40:25,541 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 11:40:26,737 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 11:40:26,737 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 11:40:26,738 - main - INFO - 应用启动...
2025-06-11 11:40:26,738 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 11:40:26,738 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 11:40:26,738 - main - INFO - 应用启动完成
2025-06-11 11:42:22,656 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 11:42:22,862 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 11:42:22,863 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 11:42:22,864 - main - INFO - 应用启动...
2025-06-11 11:42:22,864 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 11:42:22,864 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 11:42:22,864 - main - INFO - 应用启动完成
2025-06-11 11:42:57,835 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 12:27:35,582 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 12:27:35,926 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 12:27:35,927 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 12:27:35,930 - main - INFO - 应用启动...
2025-06-11 12:27:35,930 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 12:27:35,930 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 12:27:35,930 - main - INFO - 应用启动完成
2025-06-11 12:27:59,545 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 12:28:02,435 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 12:28:02,436 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 12:28:02,437 - main - INFO - 应用启动...
2025-06-11 12:28:02,437 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 12:28:02,437 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 12:28:02,437 - main - INFO - 应用启动完成
2025-06-11 12:32:58,148 - main - INFO - 应用关闭...
2025-06-11 13:36:56,772 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 13:36:57,068 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 13:36:57,069 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 13:36:57,146 - main - INFO - 应用启动...
2025-06-11 13:36:57,146 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 13:36:57,146 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 13:36:57,146 - main - INFO - 应用启动完成
2025-06-11 13:37:27,068 - main - INFO - 应用关闭...
2025-06-11 13:37:28,508 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 13:37:28,707 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 13:37:28,707 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 13:37:28,708 - main - INFO - 应用启动...
2025-06-11 13:37:31,593 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 13:37:31,593 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 13:37:31,594 - main - INFO - 应用启动完成
2025-06-11 13:37:38,163 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 13:37:38,363 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 13:37:38,364 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 13:37:38,364 - main - INFO - 应用启动...
2025-06-11 13:37:38,375 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 13:37:38,375 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 13:37:38,375 - main - INFO - 应用启动完成
2025-06-11 13:55:12,456 - main - ERROR - 全局异常: (sqlite3.OperationalError) no such column: users.is_superuser
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.is_active, users.is_superuser, users.created_at, users.updated_at 
FROM users 
WHERE users.username = ?]
[parameters: ('admin',)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\engine\default.py", line 747, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 113, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 254, in _handle_exception
    raise error
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 95, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 102, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 160, in greenlet_spawn
    value = await result
  File "D:\develop\Python38\lib\site-packages\aiosqlite\cursor.py", line 48, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "D:\develop\Python38\lib\site-packages\aiosqlite\cursor.py", line 40, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
  File "D:\develop\Python38\lib\site-packages\aiosqlite\core.py", line 132, in _execute
    return await future
  File "D:\develop\Python38\lib\site-packages\aiosqlite\core.py", line 115, in run
    result = function()
sqlite3.OperationalError: no such column: users.is_superuser

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 237, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 163, in run_endpoint_function
    return await dependant.call(**values)
  File "E:\projects\d08\extensions_web\new_app\api\v1\endpoints\auth.py", line 27, in login
    user = await auth.authenticate(
  File "E:\projects\d08\extensions_web\new_app\core\auth.py", line 196, in authenticate
    user = await db.execute(select(User).where(User.username == username))
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 313, in execute
    result = await greenlet_spawn(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 165, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\session.py", line 2229, in execute
    return self._execute_internal(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\session.py", line 2124, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\context.py", line 252, in orm_execute_statement
    result = conn.execute(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\engine\base.py", line 1414, in execute
    return meth(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\sql\elements.py", line 485, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\engine\base.py", line 2325, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\engine\default.py", line 747, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 113, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 254, in _handle_exception
    raise error
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 95, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 102, in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 160, in greenlet_spawn
    value = await result
  File "D:\develop\Python38\lib\site-packages\aiosqlite\cursor.py", line 48, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "D:\develop\Python38\lib\site-packages\aiosqlite\cursor.py", line 40, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
  File "D:\develop\Python38\lib\site-packages\aiosqlite\core.py", line 132, in _execute
    return await future
  File "D:\develop\Python38\lib\site-packages\aiosqlite\core.py", line 115, in run
    result = function()
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.is_superuser
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.is_active, users.is_superuser, users.created_at, users.updated_at 
FROM users 
WHERE users.username = ?]
[parameters: ('admin',)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-11 14:48:07,268 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 14:48:07,476 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 14:48:07,477 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 14:48:07,478 - main - INFO - 应用启动...
2025-06-11 14:48:07,489 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 14:48:07,489 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 14:48:07,489 - main - INFO - 应用启动完成
2025-06-11 15:08:09,920 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 15:08:10,244 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 15:08:10,244 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 15:08:10,245 - main - INFO - 应用启动...
2025-06-11 15:13:27,597 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 15:13:27,797 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 15:13:27,798 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 15:13:27,799 - main - INFO - 应用启动...
2025-06-11 15:13:27,810 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 15:13:27,811 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 15:13:27,811 - main - INFO - 应用启动完成
2025-06-11 15:13:40,563 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 15:13:40,761 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 15:13:40,762 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 15:13:40,762 - main - INFO - 应用启动...
2025-06-11 15:15:31,122 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 15:15:31,326 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 15:15:31,327 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 15:15:31,327 - main - INFO - 应用启动...
2025-06-11 15:17:15,561 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 15:17:15,763 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 15:17:15,763 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 15:17:15,764 - main - INFO - 应用启动...
2025-06-11 15:17:35,780 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 15:17:35,983 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 15:17:35,983 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 15:17:35,984 - main - INFO - 应用启动...
2025-06-11 15:17:38,400 - main - INFO - 权限初始化完成
2025-06-11 15:17:38,416 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 15:17:38,416 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 15:17:38,416 - main - INFO - 应用启动完成
2025-06-11 15:28:10,312 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 15:28:10,513 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 15:28:10,513 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 15:28:10,514 - main - INFO - 应用启动...
2025-06-11 15:28:10,549 - main - INFO - 权限初始化完成
2025-06-11 15:28:10,550 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 15:28:10,550 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 15:28:10,550 - main - INFO - 应用启动完成
2025-06-11 15:28:40,116 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 15:28:40,318 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 15:28:40,319 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 15:28:40,320 - main - INFO - 应用启动...
2025-06-11 15:29:02,982 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 15:29:03,185 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 15:29:03,185 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 15:29:03,186 - main - INFO - 应用启动...
2025-06-11 15:29:06,012 - main - INFO - 权限初始化完成
2025-06-11 15:29:06,013 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 15:29:06,013 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 15:29:06,013 - main - INFO - 应用启动完成
2025-06-11 15:30:29,612 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 15:30:29,818 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 15:30:29,818 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 15:30:29,819 - main - INFO - 应用启动...
2025-06-11 15:30:29,864 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 15:30:29,865 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 15:30:29,865 - main - INFO - 应用启动完成
2025-06-11 15:32:30,419 - auth - INFO - 用户尝试登录: zxc
2025-06-11 15:32:30,663 - main - ERROR - 全局异常: 'str' object has no attribute 'username'
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 237, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 163, in run_endpoint_function
    return await dependant.call(**values)
  File "E:\projects\d08\extensions_web\new_app\api\v1\endpoints\auth.py", line 97, in login_for_token
    data={"sub": user.username},
AttributeError: 'str' object has no attribute 'username'
2025-06-11 15:36:49,129 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 15:36:49,331 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 15:36:49,332 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 15:36:49,333 - main - INFO - 应用启动...
2025-06-11 15:36:49,370 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 15:36:49,370 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 15:36:49,370 - main - INFO - 应用启动完成
2025-06-11 15:36:56,453 - auth - INFO - 用户尝试登录: zxc
2025-06-11 15:36:56,716 - auth - INFO - 用户登录成功: zxc
2025-06-11 15:36:56,717 - main - ERROR - 全局异常: 'User' object is not subscriptable
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 237, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 163, in run_endpoint_function
    return await dependant.call(**values)
  File "E:\projects\d08\extensions_web\new_app\api\v1\endpoints\auth.py", line 115, in login_for_token
    "role": user['role'],
TypeError: 'User' object is not subscriptable
2025-06-11 15:37:35,773 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 15:37:35,975 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 15:37:35,975 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 15:37:35,976 - main - INFO - 应用启动...
2025-06-11 15:37:36,014 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 15:37:36,014 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 15:37:36,014 - main - INFO - 应用启动完成
2025-06-11 15:37:39,369 - auth - INFO - 用户尝试登录: zxc
2025-06-11 15:37:39,633 - auth - INFO - 用户登录成功: zxc
2025-06-11 15:37:39,634 - main - ERROR - 全局异常: 'User' object is not subscriptable
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 237, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 163, in run_endpoint_function
    return await dependant.call(**values)
  File "E:\projects\d08\extensions_web\new_app\api\v1\endpoints\auth.py", line 115, in login_for_token
    "role": user['role'],
TypeError: 'User' object is not subscriptable
2025-06-11 15:37:48,340 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 15:37:48,541 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 15:37:48,542 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 15:37:48,543 - main - INFO - 应用启动...
2025-06-11 15:37:48,578 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 15:37:48,578 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 15:37:48,579 - main - INFO - 应用启动完成
2025-06-11 15:37:53,857 - auth - INFO - 用户尝试登录: zxc
2025-06-11 15:37:54,121 - auth - INFO - 用户登录成功: zxc
2025-06-11 15:37:54,122 - main - ERROR - 全局异常: 'User' object is not subscriptable
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 237, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 163, in run_endpoint_function
    return await dependant.call(**values)
  File "E:\projects\d08\extensions_web\new_app\api\v1\endpoints\auth.py", line 115, in login_for_token
    "role": user['role'],
TypeError: 'User' object is not subscriptable
2025-06-11 15:38:28,019 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 15:38:28,222 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 15:38:28,223 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 15:38:28,224 - main - INFO - 应用启动...
2025-06-11 15:38:28,260 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 15:38:28,260 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 15:38:28,260 - main - INFO - 应用启动完成
2025-06-11 15:38:30,405 - auth - INFO - 用户尝试登录: zxc
2025-06-11 15:38:30,670 - auth - INFO - 用户登录成功: zxc
2025-06-11 15:43:26,486 - main - INFO - 应用关闭...
2025-06-11 15:43:47,665 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 15:43:47,960 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 15:43:47,960 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 15:43:47,961 - main - INFO - 应用启动...
2025-06-11 15:43:48,080 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 15:43:48,080 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 15:43:48,081 - main - INFO - 应用启动完成
2025-06-11 15:44:42,608 - auth - INFO - 用户尝试登录: tyy
2025-06-11 15:44:42,612 - auth - WARNING - 用户登录失败: tyy - 无效凭证
2025-06-11 15:44:47,628 - auth - INFO - 用户尝试登录: zxc
2025-06-11 15:44:47,908 - auth - INFO - 用户登录成功: zxc
2025-06-11 15:44:47,910 - auth - ERROR - 用户登录过程中发生错误: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)
2025-06-11 15:45:50,998 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 15:45:51,215 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 15:45:51,215 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 15:45:51,216 - main - INFO - 应用启动...
2025-06-11 15:45:51,268 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 15:45:51,268 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 15:45:51,268 - main - INFO - 应用启动完成
2025-06-11 15:45:55,814 - auth - INFO - 用户尝试登录: zxc
2025-06-11 15:45:56,076 - auth - INFO - 用户登录成功: zxc
2025-06-11 15:45:56,080 - main - ERROR - 全局异常: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 237, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 163, in run_endpoint_function
    return await dependant.call(**values)
  File "E:\projects\d08\extensions_web\new_app\api\v1\endpoints\auth.py", line 116, in login_for_token
    "role": user.roles,
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\attributes.py", line 557, in __get__
    return self.impl.get(state, dict_)  # type: ignore[no-any-return]
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\attributes.py", line 1070, in get
    value = self._fire_loader_callables(state, key, passive)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\attributes.py", line 1105, in _fire_loader_callables
    return self.callable_(state, passive)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\strategies.py", line 948, in _load_for_state
    return self._emit_lazyload(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\strategies.py", line 1111, in _emit_lazyload
    result = session.execute(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\session.py", line 2229, in execute
    return self._execute_internal(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\session.py", line 2124, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\orm\context.py", line 252, in orm_execute_statement
    result = conn.execute(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\engine\base.py", line 1414, in execute
    return meth(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\sql\elements.py", line 485, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\engine\base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\engine\base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\engine\base.py", line 2328, in _handle_dbapi_exception
    raise exc_info[1].with_traceback(exc_info[2])
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\engine\base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\engine\default.py", line 747, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 113, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 254, in _handle_exception
    raise error
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 90, in execute
    _cursor = self.await_(self._connection.cursor())
  File "D:\develop\Python38\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 93, in await_only
    raise exc.MissingGreenlet(
sqlalchemy.exc.MissingGreenlet: greenlet_spawn has not been called; can't call await_only() here. Was IO attempted in an unexpected place? (Background on this error at: https://sqlalche.me/e/20/xd2s)
2025-06-11 15:49:03,870 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 15:49:04,073 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 15:49:04,074 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 15:49:04,075 - main - INFO - 应用启动...
2025-06-11 15:49:04,114 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 15:49:04,114 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 15:49:04,114 - main - INFO - 应用启动完成
2025-06-11 15:49:15,134 - auth - INFO - 用户尝试登录: zxc
2025-06-11 15:49:15,395 - main - ERROR - 全局异常: 'User' object has no attribute 'scalar_one_or_none'
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 237, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 163, in run_endpoint_function
    return await dependant.call(**values)
  File "E:\projects\d08\extensions_web\new_app\api\v1\endpoints\auth.py", line 86, in login_for_token
    user = user.scalar_one_or_none()
AttributeError: 'User' object has no attribute 'scalar_one_or_none'
2025-06-11 15:50:17,850 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 15:50:18,067 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 15:50:18,067 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 15:50:18,069 - main - INFO - 应用启动...
2025-06-11 15:50:18,105 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 15:50:18,106 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 15:50:18,106 - main - INFO - 应用启动完成
2025-06-11 15:50:24,805 - auth - INFO - 用户尝试登录: zxc
2025-06-11 15:50:25,063 - auth - INFO - 用户登录成功: zxc
2025-06-11 15:59:28,371 - auth - INFO - 用户尝试登录: zxc
2025-06-11 15:59:28,612 - auth - INFO - 用户登录成功: zxc
2025-06-11 16:02:06,189 - auth - INFO - 用户尝试登录: zxc
2025-06-11 16:02:06,431 - auth - INFO - 用户登录成功: zxc
2025-06-11 16:02:06,533 - main - INFO - 应用关闭...
2025-06-11 16:02:08,251 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:02:08,459 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:02:08,460 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:02:08,461 - main - INFO - 应用启动...
2025-06-11 16:02:08,497 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:02:08,498 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:02:08,498 - main - INFO - 应用启动完成
2025-06-11 16:02:22,547 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:02:22,751 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:02:22,752 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:02:22,753 - main - INFO - 应用启动...
2025-06-11 16:02:22,790 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:02:22,790 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:02:22,790 - main - INFO - 应用启动完成
2025-06-11 16:02:26,366 - auth - INFO - 用户尝试登录: zxc
2025-06-11 16:02:26,630 - auth - INFO - 用户登录成功: zxc
2025-06-11 16:02:49,022 - auth - INFO - 用户尝试登录: tyy
2025-06-11 16:02:49,025 - auth - WARNING - 用户登录失败: tyy - 无效凭证
2025-06-11 16:13:23,621 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:13:23,846 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:13:23,846 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:13:23,847 - main - INFO - 应用启动...
2025-06-11 16:13:23,884 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:13:23,884 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:13:23,884 - main - INFO - 应用启动完成
2025-06-11 16:13:35,379 - main - ERROR - 全局异常: 2 validation errors for LoginResponse
response -> username
  field required (type=value_error.missing)
response -> nickname
  field required (type=value_error.missing)
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 255, in app
    content = await serialize_response(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 141, in serialize_response
    raise ValidationError(errors, field.type_)
pydantic.error_wrappers.ValidationError: 2 validation errors for LoginResponse
response -> username
  field required (type=value_error.missing)
response -> nickname
  field required (type=value_error.missing)
2025-06-11 16:14:52,677 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:14:52,890 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:14:52,890 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:14:52,891 - main - INFO - 应用启动...
2025-06-11 16:14:52,929 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:14:52,929 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:14:52,929 - main - INFO - 应用启动完成
2025-06-11 16:15:33,190 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:15:33,411 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:15:33,411 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:15:33,412 - main - INFO - 应用启动...
2025-06-11 16:15:33,449 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:15:33,450 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:15:33,450 - main - INFO - 应用启动完成
2025-06-11 16:16:47,319 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:16:47,540 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:16:47,540 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:16:47,541 - main - INFO - 应用启动...
2025-06-11 16:16:47,578 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:16:47,578 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:16:47,578 - main - INFO - 应用启动完成
2025-06-11 16:16:54,223 - main - ERROR - 全局异常: 2 validation errors for LoginResponse
response -> username
  field required (type=value_error.missing)
response -> nickname
  field required (type=value_error.missing)
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 255, in app
    content = await serialize_response(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 141, in serialize_response
    raise ValidationError(errors, field.type_)
pydantic.error_wrappers.ValidationError: 2 validation errors for LoginResponse
response -> username
  field required (type=value_error.missing)
response -> nickname
  field required (type=value_error.missing)
2025-06-11 16:17:57,762 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:17:57,978 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:17:57,978 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:17:57,979 - main - INFO - 应用启动...
2025-06-11 16:17:58,017 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:17:58,017 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:17:58,017 - main - INFO - 应用启动完成
2025-06-11 16:18:01,407 - main - ERROR - 全局异常: 1 validation error for LoginResponse
response -> user
  field required (type=value_error.missing)
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 255, in app
    content = await serialize_response(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 141, in serialize_response
    raise ValidationError(errors, field.type_)
pydantic.error_wrappers.ValidationError: 1 validation error for LoginResponse
response -> user
  field required (type=value_error.missing)
2025-06-11 16:18:15,991 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:18:16,216 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:18:16,217 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:18:16,218 - main - INFO - 应用启动...
2025-06-11 16:18:16,257 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:18:16,257 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:18:16,257 - main - INFO - 应用启动完成
2025-06-11 16:18:18,095 - main - ERROR - 全局异常: 1 validation error for LoginResponse
response -> user
  value is not a valid dict (type=type_error.dict)
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 255, in app
    content = await serialize_response(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 141, in serialize_response
    raise ValidationError(errors, field.type_)
pydantic.error_wrappers.ValidationError: 1 validation error for LoginResponse
response -> user
  value is not a valid dict (type=type_error.dict)
2025-06-11 16:18:46,674 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:18:46,896 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:18:46,896 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:18:46,897 - main - INFO - 应用启动...
2025-06-11 16:18:46,934 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:18:46,934 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:18:46,934 - main - INFO - 应用启动完成
2025-06-11 16:18:55,003 - main - ERROR - 全局异常: 1 validation error for LoginResponse
response -> user
  value is not a valid dict (type=type_error.dict)
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 255, in app
    content = await serialize_response(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 141, in serialize_response
    raise ValidationError(errors, field.type_)
pydantic.error_wrappers.ValidationError: 1 validation error for LoginResponse
response -> user
  value is not a valid dict (type=type_error.dict)
2025-06-11 16:19:28,455 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:19:28,674 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:19:28,674 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:19:28,675 - main - INFO - 应用启动...
2025-06-11 16:19:28,711 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:19:28,712 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:19:28,712 - main - INFO - 应用启动完成
2025-06-11 16:19:34,998 - main - ERROR - 全局异常: 1 validation error for LoginResponse
response -> user
  value is not a valid dict (type=type_error.dict)
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 255, in app
    content = await serialize_response(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 141, in serialize_response
    raise ValidationError(errors, field.type_)
pydantic.error_wrappers.ValidationError: 1 validation error for LoginResponse
response -> user
  value is not a valid dict (type=type_error.dict)
2025-06-11 16:20:32,334 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:20:32,567 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:20:32,568 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:20:32,569 - main - INFO - 应用启动...
2025-06-11 16:20:32,606 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:20:32,607 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:20:32,607 - main - INFO - 应用启动完成
2025-06-11 16:20:35,510 - main - ERROR - 全局异常: 1 validation error for LoginResponse
response -> user -> nickname
  field required (type=value_error.missing)
Traceback (most recent call last):
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\Python38\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "D:\develop\Python38\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\Python38\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 255, in app
    content = await serialize_response(
  File "D:\develop\Python38\lib\site-packages\fastapi\routing.py", line 141, in serialize_response
    raise ValidationError(errors, field.type_)
pydantic.error_wrappers.ValidationError: 1 validation error for LoginResponse
response -> user -> nickname
  field required (type=value_error.missing)
2025-06-11 16:21:03,383 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:21:03,611 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:21:03,611 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:21:03,612 - main - INFO - 应用启动...
2025-06-11 16:21:03,649 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:21:03,649 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:21:03,649 - main - INFO - 应用启动完成
2025-06-11 16:39:01,052 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:39:01,323 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:39:01,324 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:39:01,325 - main - INFO - 应用启动...
2025-06-11 16:39:01,390 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:39:01,390 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:39:01,390 - main - INFO - 应用启动完成
2025-06-11 16:39:31,279 - main - INFO - 应用关闭...
2025-06-11 16:39:32,893 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:39:33,119 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:39:33,119 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:39:33,120 - main - INFO - 应用启动...
2025-06-11 16:39:33,159 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:39:33,159 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:39:33,159 - main - INFO - 应用启动完成
2025-06-11 16:40:51,411 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:40:51,631 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:40:51,632 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:40:51,633 - main - INFO - 应用启动...
2025-06-11 16:40:51,683 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:40:51,683 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:40:51,683 - main - INFO - 应用启动完成
2025-06-11 16:41:13,697 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:41:13,916 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:41:13,917 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:41:13,917 - main - INFO - 应用启动...
2025-06-11 16:41:13,956 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:41:13,956 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:41:13,956 - main - INFO - 应用启动完成
2025-06-11 16:41:56,161 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:41:56,384 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:41:56,384 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:41:56,385 - main - INFO - 应用启动...
2025-06-11 16:41:56,423 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:41:56,423 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:41:56,423 - main - INFO - 应用启动完成
2025-06-11 16:47:22,134 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:47:22,353 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:47:22,354 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:47:22,354 - main - INFO - 应用启动...
2025-06-11 16:47:22,392 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:47:22,392 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:47:22,392 - main - INFO - 应用启动完成
2025-06-11 16:47:58,157 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:47:58,489 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:47:58,489 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:47:58,490 - main - INFO - 应用启动...
2025-06-11 16:47:58,528 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:47:58,528 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:47:58,529 - main - INFO - 应用启动完成
2025-06-11 16:55:11,460 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:55:11,674 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:55:11,675 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:55:11,676 - main - INFO - 应用启动...
2025-06-11 16:55:11,712 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:55:11,712 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:55:11,713 - main - INFO - 应用启动完成
2025-06-11 16:59:07,603 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 16:59:07,834 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 16:59:07,835 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 16:59:07,836 - main - INFO - 应用启动...
2025-06-11 16:59:07,873 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 16:59:07,873 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 16:59:07,873 - main - INFO - 应用启动完成
2025-06-11 17:00:42,955 - auth - INFO - 用户尝试登录: zxc
2025-06-11 17:00:43,218 - auth - INFO - 用户登录成功: zxc
2025-06-11 17:02:16,521 - websocket_manager - INFO - 用户 1 建立WebSocket连接
2025-06-11 17:04:06,152 - websocket_manager - INFO - 用户 1 断开WebSocket连接
2025-06-11 17:04:06,239 - main - INFO - 应用关闭...
2025-06-11 17:04:22,140 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 17:04:22,472 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 17:04:22,473 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 17:04:22,474 - main - INFO - 应用启动...
2025-06-11 17:04:22,510 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 17:04:22,511 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 17:04:22,511 - main - INFO - 应用启动完成
2025-06-11 17:04:22,516 - websocket_manager - INFO - 用户 1 建立WebSocket连接
2025-06-11 17:18:41,017 - websocket_manager - INFO - 用户 1 断开WebSocket连接
2025-06-11 17:18:45,156 - websocket_manager - INFO - 用户 1 建立WebSocket连接
2025-06-11 17:18:45,245 - websocket_manager - INFO - 用户 1 断开WebSocket连接
2025-06-11 17:18:45,347 - main - INFO - 应用关闭...
2025-06-11 17:25:03,857 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 17:25:04,239 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 17:25:04,239 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 17:25:04,240 - main - INFO - 应用启动...
2025-06-11 17:27:47,470 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 17:27:47,723 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 17:27:47,724 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 17:27:47,725 - main - INFO - 应用启动...
2025-06-11 17:30:10,769 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 17:30:11,035 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 17:30:11,036 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 17:30:11,037 - main - INFO - 应用启动...
2025-06-11 17:31:22,308 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 17:31:22,560 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 17:31:22,561 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 17:31:22,562 - main - INFO - 应用启动...
2025-06-11 17:31:22,861 - auth - INFO - 用户初始化完成
2025-06-11 17:31:22,996 - auth - INFO - 权限初始化完成
2025-06-11 17:31:23,094 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 17:31:23,094 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 17:31:23,094 - main - INFO - 应用启动完成
2025-06-11 17:31:26,690 - websocket_manager - INFO - 用户 1 建立WebSocket连接
2025-06-11 20:05:22,591 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 20:05:23,208 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 20:05:23,209 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 20:05:23,210 - main - INFO - 应用启动...
2025-06-11 20:05:23,265 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 20:05:23,266 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 20:05:23,266 - main - INFO - 应用启动完成
2025-06-11 20:11:07,226 - main - INFO - 应用关闭...
2025-06-11 20:11:11,264 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 20:11:11,543 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 20:11:11,544 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 20:11:11,545 - main - INFO - 应用启动...
2025-06-11 20:11:11,599 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 20:11:11,599 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 20:11:11,599 - main - INFO - 应用启动完成
2025-06-11 20:13:33,953 - main - INFO - 应用关闭...
2025-06-11 20:13:38,313 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 20:13:38,580 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 20:13:38,581 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 20:13:38,582 - main - INFO - 应用启动...
2025-06-11 20:13:38,636 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 20:13:38,636 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 20:13:38,636 - main - INFO - 应用启动完成
2025-06-11 20:49:38,940 - main - INFO - 应用关闭...
2025-06-11 20:51:50,093 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 20:52:54,899 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 20:52:55,181 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 20:53:28,317 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 20:53:28,598 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 20:53:28,598 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 20:53:28,599 - main - INFO - 应用启动...
2025-06-11 20:53:50,565 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 20:53:50,856 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 20:53:50,856 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 20:53:50,857 - main - INFO - 应用启动...
2025-06-11 20:54:02,033 - auth - INFO - 用户初始化完成
2025-06-11 20:54:02,321 - auth - INFO - 权限初始化完成
2025-06-11 20:54:02,724 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 20:54:02,724 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 20:54:02,724 - main - INFO - 应用启动完成
2025-06-11 20:55:09,814 - main - INFO - 应用关闭...
2025-06-11 20:55:12,230 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 20:55:12,515 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 20:55:12,515 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 20:55:12,516 - main - INFO - 应用启动...
2025-06-11 20:55:12,569 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 20:55:12,569 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 20:55:12,569 - main - INFO - 应用启动完成
2025-06-11 20:55:32,026 - main - ERROR - 全局异常: 1 validation errors:
  {'type': 'model_attributes_type', 'loc': ('response',), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': [<new_app.models.file.File object at 0x000001FCEB35ECA0>, <new_app.models.file.File object at 0x000001FCEB35AE50>], 'url': 'https://errors.pydantic.dev/2.3/v/model_attributes_type'}
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 154, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 1 validation errors:
  {'type': 'model_attributes_type', 'loc': ('response',), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': [<new_app.models.file.File object at 0x000001FCEB35ECA0>, <new_app.models.file.File object at 0x000001FCEB35AE50>], 'url': 'https://errors.pydantic.dev/2.3/v/model_attributes_type'}

2025-06-11 21:20:54,139 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 21:20:54,461 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 21:20:54,462 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 21:20:54,462 - main - INFO - 应用启动...
2025-06-11 21:20:54,517 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 21:20:54,517 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 21:20:54,517 - main - INFO - 应用启动完成
2025-06-11 21:21:20,392 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 21:21:20,701 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 21:21:20,701 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 21:21:20,702 - main - INFO - 应用启动...
2025-06-11 21:21:20,758 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 21:21:20,758 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 21:21:20,758 - main - INFO - 应用启动完成
2025-06-11 21:23:09,586 - main - INFO - 应用关闭...
2025-06-11 21:23:12,159 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 21:23:12,458 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 21:23:12,459 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 21:23:12,459 - main - INFO - 应用启动...
2025-06-11 21:23:12,515 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 21:23:12,516 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 21:23:12,516 - main - INFO - 应用启动完成
2025-06-11 21:23:17,798 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 21:23:18,111 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 21:23:18,113 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 21:23:18,114 - main - INFO - 应用启动...
2025-06-11 21:23:18,168 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 21:23:18,168 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 21:23:18,168 - main - INFO - 应用启动完成
2025-06-11 21:23:33,795 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 21:23:34,133 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 21:23:34,133 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 21:23:34,134 - main - INFO - 应用启动...
2025-06-11 21:23:46,499 - auth - INFO - 用户初始化完成
2025-06-11 21:23:46,800 - auth - INFO - 权限初始化完成
2025-06-11 21:23:47,042 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 21:23:47,042 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 21:23:47,042 - main - INFO - 应用启动完成
2025-06-11 21:23:51,967 - main - ERROR - 全局异常: unsupported operand type(s) for |: 'str' and 'str'
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 124, in get_files
    path = request.query_params.get("path") | "/"
TypeError: unsupported operand type(s) for |: 'str' and 'str'
2025-06-11 21:24:10,567 - main - INFO - 应用关闭...
2025-06-11 21:24:14,722 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 21:24:15,208 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 21:24:15,208 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 21:24:15,210 - main - INFO - 应用启动...
2025-06-11 21:24:15,372 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 21:24:15,372 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 21:24:15,372 - main - INFO - 应用启动完成
2025-06-11 21:24:18,195 - new_app.core.file_manager - ERROR - 获取目录下所有文件失败: 'coroutine' object has no attribute 'scalars'
2025-06-11 21:24:34,006 - main - INFO - 应用关闭...
2025-06-11 21:24:38,072 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 21:24:38,439 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 21:24:38,440 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 21:24:38,441 - main - INFO - 应用启动...
2025-06-11 21:24:38,507 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 21:24:38,508 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 21:24:38,508 - main - INFO - 应用启动完成
2025-06-11 21:24:42,804 - new_app.core.file_manager - ERROR - 获取目录下所有文件失败: 'coroutine' object has no attribute 'scalars'
2025-06-11 21:24:42,809 - main - ERROR - 全局异常: object list can't be used in 'await' expression
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 126, in get_files
    files = await file_manager.get_dir_files(path)
TypeError: object list can't be used in 'await' expression
2025-06-11 21:25:32,363 - main - INFO - 应用关闭...
2025-06-11 21:25:34,844 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 21:25:35,175 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 21:25:35,175 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 21:25:35,176 - main - INFO - 应用启动...
2025-06-11 21:25:35,233 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 21:25:35,233 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 21:25:35,233 - main - INFO - 应用启动完成
2025-06-11 21:27:49,036 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 21:27:49,376 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 21:27:49,376 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 21:27:49,377 - main - INFO - 应用启动...
2025-06-11 21:27:49,437 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 21:27:49,437 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 21:27:49,437 - main - INFO - 应用启动完成
2025-06-11 21:34:52,277 - main - ERROR - 全局异常: unsupported operand type(s) for |: 'NoneType' and 'str'
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 30, in upload_file
    path = request.query_params.get("path") | "/"
TypeError: unsupported operand type(s) for |: 'NoneType' and 'str'
2025-06-11 21:35:25,628 - main - INFO - 应用关闭...
2025-06-11 21:35:27,996 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 21:35:28,285 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 21:35:28,285 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 21:35:28,286 - main - INFO - 应用启动...
2025-06-11 21:35:28,338 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 21:35:28,339 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 21:35:28,339 - main - INFO - 应用启动完成
2025-06-11 21:35:34,840 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 21:35:35,122 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 21:35:35,122 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 21:35:35,124 - main - INFO - 应用启动...
2025-06-11 21:35:35,177 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 21:35:35,177 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 21:35:35,177 - main - INFO - 应用启动完成
2025-06-11 21:36:05,030 - main - INFO - 应用关闭...
2025-06-11 21:36:07,833 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 21:36:08,193 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 21:36:08,193 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 21:36:08,194 - main - INFO - 应用启动...
2025-06-11 21:36:08,257 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 21:36:08,257 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 21:36:08,258 - main - INFO - 应用启动完成
2025-06-11 21:36:28,225 - main - INFO - 应用关闭...
2025-06-11 21:36:31,021 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 21:36:31,377 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 21:36:31,377 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 21:36:31,378 - main - INFO - 应用启动...
2025-06-11 21:36:31,447 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 21:36:31,448 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 21:36:31,448 - main - INFO - 应用启动完成
2025-06-11 21:42:40,838 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 21:42:41,112 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 21:42:41,112 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 21:42:41,113 - main - INFO - 应用启动...
2025-06-11 21:42:41,165 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 21:42:41,165 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 21:42:41,166 - main - INFO - 应用启动完成
2025-06-11 22:04:04,858 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-11 22:10:49,201 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-11 22:19:29,054 - main - INFO - 应用关闭...
2025-06-11 22:19:31,518 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-11 22:19:32,002 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-11 22:19:32,002 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-11 22:19:32,004 - main - INFO - 应用启动...
2025-06-11 22:19:32,100 - extension_manager - INFO - 开始加载所有扩展
2025-06-11 22:19:32,100 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-11 22:19:32,100 - main - INFO - 应用启动完成
2025-06-11 22:19:32,114 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-11 22:19:32,114 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-11 22:21:29,741 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-11 22:21:43,552 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-11 22:21:43,959 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-11 22:21:47,286 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-11 22:25:53,497 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-11 22:41:25,658 - main - INFO - 应用关闭...
2025-06-12 08:53:35,960 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 08:53:36,638 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 08:53:36,638 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 08:53:36,640 - main - INFO - 应用启动...
2025-06-12 08:53:36,757 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 08:53:36,758 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 08:53:36,758 - main - INFO - 应用启动完成
2025-06-12 08:56:47,439 - new_app.core.file_manager - ERROR - 保存文件失败: '\\20250612_085647_c1599e9ece36d0125d520658d68f6634.jpg' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
2025-06-12 08:57:53,183 - new_app.core.file_manager - ERROR - 保存文件失败: '\\20250612_085753_c1599e9ece36d0125d520658d68f6634.jpg' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
2025-06-12 08:58:13,528 - new_app.core.file_manager - ERROR - 保存文件失败: '\\20250612_085813_c1599e9ece36d0125d520658d68f6634.jpg' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
2025-06-12 08:59:17,756 - new_app.core.file_manager - ERROR - 保存文件失败: '\\20250612_085917_bc04db470c2e8e8c77687e1163b8290d.jpg' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
2025-06-12 09:01:08,987 - new_app.core.file_manager - ERROR - 保存文件失败: '\\20250612_090108_c1599e9ece36d0125d520658d68f6634.jpg' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
2025-06-12 09:07:31,719 - main - INFO - 应用关闭...
2025-06-12 09:15:13,937 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 09:15:14,351 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 09:15:14,352 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 09:15:14,352 - main - INFO - 应用启动...
2025-06-12 09:15:14,414 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 09:15:14,414 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 09:15:14,415 - main - INFO - 应用启动完成
2025-06-12 09:18:27,390 - main - INFO - 应用关闭...
2025-06-12 09:18:32,767 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 09:18:33,183 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 09:18:33,184 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 09:18:33,185 - main - INFO - 应用启动...
2025-06-12 09:18:33,262 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 09:18:33,262 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 09:18:33,262 - main - INFO - 应用启动完成
2025-06-12 09:22:57,812 - main - INFO - 应用关闭...
2025-06-12 09:23:02,880 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 09:23:03,295 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 09:23:03,295 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 09:23:03,298 - main - INFO - 应用启动...
2025-06-12 09:23:03,373 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 09:23:03,373 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 09:23:03,373 - main - INFO - 应用启动完成
2025-06-12 09:34:40,715 - main - INFO - 应用关闭...
2025-06-12 09:34:47,236 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 09:34:47,720 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 09:34:47,721 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 09:34:47,722 - main - INFO - 应用启动...
2025-06-12 09:34:47,786 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 09:34:47,787 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 09:34:47,787 - main - INFO - 应用启动完成
2025-06-12 09:53:07,447 - new_app.core.file_manager - ERROR - 保存文件失败: 'G:\\cursor_projects\\extensions_web\\file_uploads\\20250612_095307_d9a30e3c_ExtensionsView.vue' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 114, in save_file
    filepath=str(file_path.relative_to(self.upload_dir)),
  File "D:\develop\python396\lib\pathlib.py", line 929, in relative_to
    raise ValueError("{!r} is not in the subpath of {!r}"
ValueError: 'G:\\cursor_projects\\extensions_web\\file_uploads\\20250612_095307_d9a30e3c_ExtensionsView.vue' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
2025-06-12 09:54:34,046 - new_app.core.file_manager - ERROR - 保存文件失败: 'G:\\cursor_projects\\extensions_web\\file_uploads\\20250612_095434_d9a30e3c_ExtensionsView.vue' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 114, in save_file
    filepath=str(file_path.relative_to(self.upload_dir)),
  File "D:\develop\python396\lib\pathlib.py", line 929, in relative_to
    raise ValueError("{!r} is not in the subpath of {!r}"
ValueError: 'G:\\cursor_projects\\extensions_web\\file_uploads\\20250612_095434_d9a30e3c_ExtensionsView.vue' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
2025-06-12 09:59:28,837 - new_app.core.file_manager - ERROR - 保存文件失败: 'G:\\cursor_projects\\extensions_web\\file_uploads\\20250612_095928_fe4ff69c_FileManagerView.vue' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 114, in save_file
    filepath=str(file_path.relative_to(self.upload_dir)),
  File "D:\develop\python396\lib\pathlib.py", line 929, in relative_to
    raise ValueError("{!r} is not in the subpath of {!r}"
ValueError: 'G:\\cursor_projects\\extensions_web\\file_uploads\\20250612_095928_fe4ff69c_FileManagerView.vue' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
2025-06-12 10:10:48,424 - main - INFO - 应用关闭...
2025-06-12 10:10:51,941 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 10:10:52,287 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 10:10:52,287 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 10:10:52,289 - main - INFO - 应用启动...
2025-06-12 10:10:52,369 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 10:10:52,369 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 10:10:52,369 - main - INFO - 应用启动完成
2025-06-12 10:14:22,836 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 10:14:24,410 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 10:14:25,993 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 10:14:27,733 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 10:14:30,551 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 10:14:33,866 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 10:14:34,482 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 10:14:34,842 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 10:14:38,172 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 10:14:50,377 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 10:14:50,378 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 10:14:50,378 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 10:14:50,481 - main - INFO - 应用关闭...
2025-06-12 13:53:53,493 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 13:53:54,164 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 13:53:54,165 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 13:53:54,167 - main - INFO - 应用启动...
2025-06-12 13:53:54,249 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 13:53:54,249 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 13:53:54,249 - main - INFO - 应用启动完成
2025-06-12 13:59:40,857 - main - INFO - 应用关闭...
2025-06-12 13:59:43,576 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 13:59:44,144 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 13:59:44,145 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 13:59:44,150 - main - INFO - 应用启动...
2025-06-12 13:59:44,259 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 13:59:44,259 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 13:59:44,259 - main - INFO - 应用启动完成
2025-06-12 14:00:09,898 - main - INFO - 应用关闭...
2025-06-12 14:00:12,087 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 14:00:12,517 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 14:00:12,517 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 14:00:12,521 - main - INFO - 应用启动...
2025-06-12 14:00:12,596 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 14:00:12,597 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 14:00:12,597 - main - INFO - 应用启动完成
2025-06-12 14:18:52,936 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:22:12,972 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:22:13,636 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:22:16,288 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:22:20,160 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:22:21,479 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:22:23,490 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:27:27,566 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:27:28,262 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:27:28,285 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:27:30,921 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:27:57,837 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:27:58,227 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:28:01,156 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:28:01,444 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:28:01,445 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:28:01,447 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:28:01,449 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:28:01,453 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:28:01,457 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:29:06,863 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:29:15,313 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:29:16,609 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:29:18,639 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:29:31,864 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:29:34,701 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:29:35,190 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:30:20,503 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:30:20,891 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:30:20,911 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:30:24,308 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:30:30,596 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:30:30,600 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:30:30,607 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:30:30,608 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:30:30,611 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:30:34,034 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:34:23,181 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:34:23,285 - main - INFO - 应用关闭...
2025-06-12 14:34:25,602 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 14:34:26,048 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 14:34:26,049 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 14:34:26,052 - main - INFO - 应用启动...
2025-06-12 14:34:26,144 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 14:34:26,144 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 14:34:26,145 - main - INFO - 应用启动完成
2025-06-12 14:34:27,304 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:34:44,738 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:34:44,842 - main - INFO - 应用关闭...
2025-06-12 14:34:47,069 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 14:34:47,554 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 14:34:47,554 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 14:34:47,554 - main - INFO - 应用启动...
2025-06-12 14:34:47,634 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 14:34:47,635 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 14:34:47,635 - main - INFO - 应用启动完成
2025-06-12 14:34:48,050 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:34:48,215 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:34:51,300 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:36:04,319 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:36:04,995 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:36:07,656 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:36:19,006 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:36:19,008 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:36:21,597 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:36:59,952 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:37:00,606 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:37:03,273 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:37:22,643 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:37:23,986 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:37:25,972 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:40:10,096 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:40:10,763 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:40:13,417 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:40:17,819 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:40:17,821 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:40:17,822 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:40:17,823 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:40:20,715 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:40:52,214 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:40:52,875 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:40:56,306 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:41:23,883 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:41:24,238 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:41:27,305 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:43:14,564 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:43:15,212 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:43:18,308 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:44:26,883 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:44:27,546 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:44:30,302 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:44:49,390 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:44:49,767 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:44:53,306 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:46:34,077 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:46:34,081 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:46:34,084 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:46:34,086 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:46:34,092 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:46:34,093 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:56:16,662 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:59:03,122 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:59:03,785 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:59:06,455 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:59:08,639 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:59:08,640 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 14:59:13,615 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 14:59:28,896 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 14:59:29,023 - main - ERROR - 全局异常: (sqlite3.OperationalError) no such column: users.role
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.nickname, users.role, users.is_active, users.created_at, users.updated_at, users.last_login 
FROM users 
WHERE users.id IN (SELECT 1 FROM (SELECT 1) WHERE 1!=1)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 48, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 40, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 133, in _execute
    return await future
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 106, in run
    result = function()
sqlite3.OperationalError: no such column: users.role

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\ws.py", line 545, in get_room_messages
    users_result = await session.execute(users_query)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 48, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 40, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 133, in _execute
    return await future
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 106, in run
    result = function()
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.role
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.nickname, users.role, users.is_active, users.created_at, users.updated_at, users.last_login 
FROM users 
WHERE users.id IN (SELECT 1 FROM (SELECT 1) WHERE 1!=1)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-12 15:00:51,208 - websocket_manager - INFO - 用户 2 离开房间 room_1
2025-06-12 15:00:51,208 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 15:00:51,875 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 15:00:54,522 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 15:00:56,658 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:00:56,694 - main - ERROR - 全局异常: (sqlite3.OperationalError) no such column: users.role
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.nickname, users.role, users.is_active, users.created_at, users.updated_at, users.last_login 
FROM users 
WHERE users.id IN (SELECT 1 FROM (SELECT 1) WHERE 1!=1)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 48, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 40, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 133, in _execute
    return await future
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 106, in run
    result = function()
sqlite3.OperationalError: no such column: users.role

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\ws.py", line 545, in get_room_messages
    users_result = await session.execute(users_query)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 48, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 40, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 133, in _execute
    return await future
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 106, in run
    result = function()
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.role
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.nickname, users.role, users.is_active, users.created_at, users.updated_at, users.last_login 
FROM users 
WHERE users.id IN (SELECT 1 FROM (SELECT 1) WHERE 1!=1)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-12 15:01:06,129 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:01:06,147 - main - ERROR - 全局异常: (sqlite3.OperationalError) no such column: users.role
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.nickname, users.role, users.is_active, users.created_at, users.updated_at, users.last_login 
FROM users 
WHERE users.id IN (SELECT 1 FROM (SELECT 1) WHERE 1!=1)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 48, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 40, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 133, in _execute
    return await future
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 106, in run
    result = function()
sqlite3.OperationalError: no such column: users.role

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\ws.py", line 545, in get_room_messages
    users_result = await session.execute(users_query)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 48, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 40, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 133, in _execute
    return await future
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 106, in run
    result = function()
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.role
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.nickname, users.role, users.is_active, users.created_at, users.updated_at, users.last_login 
FROM users 
WHERE users.id IN (SELECT 1 FROM (SELECT 1) WHERE 1!=1)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-12 15:01:13,890 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 15:01:13,891 - websocket_manager - INFO - 用户 2 离开房间 room_1
2025-06-12 15:01:13,892 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 15:01:15,949 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 15:01:17,002 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:01:17,030 - main - ERROR - 全局异常: (sqlite3.OperationalError) no such column: users.role
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.nickname, users.role, users.is_active, users.created_at, users.updated_at, users.last_login 
FROM users 
WHERE users.id IN (SELECT 1 FROM (SELECT 1) WHERE 1!=1)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 48, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 40, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 133, in _execute
    return await future
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 106, in run
    result = function()
sqlite3.OperationalError: no such column: users.role

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\ws.py", line 545, in get_room_messages
    users_result = await session.execute(users_query)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 48, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 40, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 133, in _execute
    return await future
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 106, in run
    result = function()
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.role
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.nickname, users.role, users.is_active, users.created_at, users.updated_at, users.last_login 
FROM users 
WHERE users.id IN (SELECT 1 FROM (SELECT 1) WHERE 1!=1)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-12 15:01:20,530 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:01:20,844 - main - ERROR - 全局异常: (sqlite3.OperationalError) no such column: users.role
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.nickname, users.role, users.is_active, users.created_at, users.updated_at, users.last_login 
FROM users 
WHERE users.id IN (SELECT 1 FROM (SELECT 1) WHERE 1!=1)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 48, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 40, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 133, in _execute
    return await future
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 106, in run
    result = function()
sqlite3.OperationalError: no such column: users.role

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\ws.py", line 545, in get_room_messages
    users_result = await session.execute(users_query)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 48, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 40, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 133, in _execute
    return await future
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 106, in run
    result = function()
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.role
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.nickname, users.role, users.is_active, users.created_at, users.updated_at, users.last_login 
FROM users 
WHERE users.id IN (SELECT 1 FROM (SELECT 1) WHERE 1!=1)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-12 15:02:39,566 - websocket_manager - INFO - 用户 2 离开房间 room_1
2025-06-12 15:02:39,567 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 15:02:39,672 - main - INFO - 应用关闭...
2025-06-12 15:02:41,943 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 15:02:42,415 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 15:02:42,415 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 15:02:42,415 - main - INFO - 应用启动...
2025-06-12 15:02:42,497 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 15:02:42,504 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 15:02:42,504 - main - INFO - 应用启动完成
2025-06-12 15:02:43,303 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 15:02:48,272 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:02:59,193 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:03:00,406 - websocket_manager - INFO - 用户 2 离开房间 room_1
2025-06-12 15:03:00,406 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 15:03:03,734 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 15:03:14,829 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 15:03:16,589 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:03:16,667 - main - ERROR - 全局异常: (sqlite3.OperationalError) no such column: users.role
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.nickname, users.role, users.is_active, users.created_at, users.updated_at, users.last_login 
FROM users 
WHERE users.id IN (SELECT 1 FROM (SELECT 1) WHERE 1!=1)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 48, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 40, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 133, in _execute
    return await future
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 106, in run
    result = function()
sqlite3.OperationalError: no such column: users.role

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\ws.py", line 545, in get_room_messages
    users_result = await session.execute(users_query)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 48, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 40, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 133, in _execute
    return await future
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 106, in run
    result = function()
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.role
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.nickname, users.role, users.is_active, users.created_at, users.updated_at, users.last_login 
FROM users 
WHERE users.id IN (SELECT 1 FROM (SELECT 1) WHERE 1!=1)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-12 15:03:17,600 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 15:03:18,931 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 15:03:20,952 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 15:03:55,829 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:03:56,171 - main - ERROR - 全局异常: (sqlite3.OperationalError) no such column: users.role
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.nickname, users.role, users.is_active, users.created_at, users.updated_at, users.last_login 
FROM users 
WHERE users.id IN (SELECT 1 FROM (SELECT 1) WHERE 1!=1)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 48, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 40, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 133, in _execute
    return await future
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 106, in run
    result = function()
sqlite3.OperationalError: no such column: users.role

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\ws.py", line 545, in get_room_messages
    users_result = await session.execute(users_query)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 48, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 40, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 133, in _execute
    return await future
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 106, in run
    result = function()
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.role
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.nickname, users.role, users.is_active, users.created_at, users.updated_at, users.last_login 
FROM users 
WHERE users.id IN (SELECT 1 FROM (SELECT 1) WHERE 1!=1)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-12 15:04:24,822 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:04:24,843 - main - ERROR - 全局异常: (sqlite3.OperationalError) no such column: users.role
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.nickname, users.role, users.is_active, users.created_at, users.updated_at, users.last_login 
FROM users 
WHERE users.id IN (SELECT 1 FROM (SELECT 1) WHERE 1!=1)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 48, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 40, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 133, in _execute
    return await future
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 106, in run
    result = function()
sqlite3.OperationalError: no such column: users.role

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\ws.py", line 545, in get_room_messages
    users_result = await session.execute(users_query)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "D:\develop\python396\lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
  File "D:\develop\python396\lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 48, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "D:\develop\python396\lib\site-packages\aiosqlite\cursor.py", line 40, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 133, in _execute
    return await future
  File "D:\develop\python396\lib\site-packages\aiosqlite\core.py", line 106, in run
    result = function()
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.role
[SQL: SELECT users.id, users.username, users.email, users.hashed_password, users.nickname, users.role, users.is_active, users.created_at, users.updated_at, users.last_login 
FROM users 
WHERE users.id IN (SELECT 1 FROM (SELECT 1) WHERE 1!=1)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-12 15:08:42,752 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 15:08:42,754 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 15:08:42,757 - websocket_manager - INFO - 用户 2 离开房间 room_1
2025-06-12 15:08:42,758 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 15:08:42,845 - main - INFO - 应用关闭...
2025-06-12 15:08:45,263 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 15:08:45,712 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 15:08:45,713 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 15:08:45,716 - main - INFO - 应用启动...
2025-06-12 15:10:09,873 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 15:10:10,257 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 15:10:10,257 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 15:10:10,260 - main - INFO - 应用启动...
2025-06-12 15:10:46,225 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 15:10:46,623 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 15:10:46,623 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 15:10:46,623 - main - INFO - 应用启动...
2025-06-12 15:10:56,734 - auth - INFO - 用户初始化完成
2025-06-12 15:10:57,158 - auth - INFO - 权限初始化完成
2025-06-12 15:10:57,603 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 15:10:57,603 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 15:10:57,603 - main - INFO - 应用启动完成
2025-06-12 15:11:01,423 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 15:11:08,179 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:11:09,763 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:11:54,960 - websocket_manager - INFO - 用户 2 离开房间 room_1
2025-06-12 15:11:54,960 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 15:11:56,390 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 15:11:57,124 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:11:58,284 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 15:12:09,108 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:12:15,334 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:12:22,607 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:12:38,338 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:12:47,318 - websocket_manager - INFO - 用户 2 加入房间 room_2
2025-06-12 15:12:48,746 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:12:49,803 - websocket_manager - INFO - 用户 2 加入房间 room_2
2025-06-12 15:12:50,563 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:12:51,533 - websocket_manager - INFO - 用户 2 加入房间 room_2
2025-06-12 15:12:52,695 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:13:00,816 - websocket_manager - INFO - 用户 2 加入房间 room_2
2025-06-12 15:13:01,563 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:13:02,562 - websocket_manager - INFO - 用户 2 加入房间 room_2
2025-06-12 15:13:02,981 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:13:03,559 - websocket_manager - INFO - 用户 2 加入房间 room_2
2025-06-12 15:13:04,011 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:13:08,765 - websocket_manager - INFO - 用户 2 加入房间 room_2
2025-06-12 15:13:09,405 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:13:10,280 - websocket_manager - INFO - 用户 2 加入房间 room_2
2025-06-12 15:13:10,713 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:18:34,244 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 15:18:34,246 - websocket_manager - INFO - 用户 2 离开房间 room_2
2025-06-12 15:18:34,246 - websocket_manager - INFO - 用户 2 离开房间 room_1
2025-06-12 15:18:34,247 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 15:18:34,352 - main - INFO - 应用关闭...
2025-06-12 15:18:36,562 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 15:18:36,953 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 15:18:36,954 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 15:18:36,956 - main - INFO - 应用启动...
2025-06-12 15:18:37,032 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 15:18:37,033 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 15:18:37,034 - main - INFO - 应用启动完成
2025-06-12 15:18:38,317 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 15:18:38,347 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 15:18:43,371 - websocket_manager - INFO - 用户 2 加入房间 room_2
2025-06-12 15:18:44,156 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:18:44,932 - websocket_manager - INFO - 用户 2 加入房间 room_2
2025-06-12 15:18:45,660 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:18:48,019 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:18:48,340 - websocket_manager - INFO - 用户 2 加入房间 room_2
2025-06-12 15:18:48,809 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:18:50,310 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 15:18:50,314 - websocket_manager - INFO - 用户 2 离开房间 room_2
2025-06-12 15:18:50,315 - websocket_manager - INFO - 用户 2 离开房间 room_1
2025-06-12 15:18:50,315 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 15:18:54,298 - websocket_manager - INFO - 用户 2 建立WebSocket连接
2025-06-12 15:18:54,831 - websocket_manager - INFO - 用户 2 加入房间 room_1
2025-06-12 15:18:55,760 - websocket_manager - INFO - 用户 2 加入房间 room_2
2025-06-12 15:22:20,881 - websocket_manager - INFO - 用户 2 离开房间 room_2
2025-06-12 15:22:20,885 - websocket_manager - INFO - 用户 2 离开房间 room_1
2025-06-12 15:22:20,885 - websocket_manager - INFO - 用户 2 断开WebSocket连接
2025-06-12 15:35:01,434 - main - INFO - 应用关闭...
2025-06-12 15:35:03,767 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 15:35:04,281 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 15:35:04,282 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 15:35:04,284 - main - INFO - 应用启动...
2025-06-12 15:35:04,374 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 15:35:04,375 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 15:35:04,375 - main - INFO - 应用启动完成
2025-06-12 15:35:34,662 - main - INFO - 应用关闭...
2025-06-12 15:35:36,905 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 15:35:37,409 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 15:35:37,410 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 15:35:37,411 - main - INFO - 应用启动...
2025-06-12 15:35:37,516 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 15:35:37,516 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 15:35:37,516 - main - INFO - 应用启动完成
2025-06-12 15:37:44,659 - main - INFO - 应用关闭...
2025-06-12 15:37:46,944 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 15:37:47,362 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 15:37:47,363 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 15:37:47,365 - main - INFO - 应用启动...
2025-06-12 15:37:47,438 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 15:37:47,438 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 15:37:47,439 - main - INFO - 应用启动完成
2025-06-12 15:38:19,841 - main - INFO - 应用关闭...
2025-06-12 15:38:22,430 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 15:38:22,997 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 15:38:23,004 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 15:38:23,064 - main - INFO - 应用启动...
2025-06-12 15:38:23,163 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 15:38:23,163 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 15:38:23,164 - main - INFO - 应用启动完成
2025-06-12 15:39:47,665 - main - INFO - 应用关闭...
2025-06-12 15:39:49,985 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 15:39:50,483 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 15:39:50,484 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 15:39:50,488 - main - INFO - 应用启动...
2025-06-12 15:39:50,582 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 15:39:50,583 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 15:39:50,583 - main - INFO - 应用启动完成
2025-06-12 15:40:03,961 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 15:40:05,318 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 15:40:06,438 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 15:40:07,481 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 15:40:08,333 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 15:40:18,353 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 15:40:18,976 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 15:40:19,731 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 15:40:20,199 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 15:40:22,794 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 15:40:23,599 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 15:40:24,487 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 15:40:25,109 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 15:40:29,404 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 15:40:29,970 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 15:40:30,575 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 15:40:31,023 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 15:41:53,845 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 15:41:53,846 - websocket_manager - INFO - 用户 admin 离开聊天室 2
2025-06-12 15:41:53,846 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-12 15:41:54,489 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 15:41:57,160 - websocket_manager - INFO - 关闭用户 admin 的旧连接
2025-06-12 15:41:57,160 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 15:41:57,167 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 15:42:00,691 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 15:42:04,198 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 15:42:05,389 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 15:42:06,909 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 15:42:07,773 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 15:42:29,604 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 15:42:30,151 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 15:43:13,236 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 15:43:13,236 - websocket_manager - INFO - 用户 admin 离开聊天室 2
2025-06-12 15:43:13,237 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-12 15:43:13,598 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 15:43:16,369 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 15:43:18,637 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 15:43:20,283 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 15:43:21,733 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 15:43:22,891 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 15:43:23,567 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 15:52:12,555 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 15:52:12,555 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-12 15:52:12,555 - websocket_manager - INFO - 用户 admin 离开聊天室 2
2025-06-12 15:52:12,659 - main - INFO - 应用关闭...
2025-06-12 15:52:14,937 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 15:52:15,520 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 15:52:15,520 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 15:52:15,526 - main - INFO - 应用启动...
2025-06-12 15:52:15,669 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 15:52:15,670 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 15:52:15,670 - main - INFO - 应用启动完成
2025-06-12 15:52:16,302 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 15:57:11,039 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 15:59:46,848 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 15:59:53,648 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 15:59:54,782 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 16:00:04,959 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 16:00:06,029 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 16:00:06,030 - websocket_manager - INFO - 用户 admin 离开聊天室 2
2025-06-12 16:00:06,031 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-12 16:00:08,851 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 16:00:09,860 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 16:00:41,622 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 16:00:41,623 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-12 16:00:42,274 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 16:00:45,327 - websocket_manager - INFO - 关闭用户 admin 的旧连接
2025-06-12 16:00:45,327 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 16:00:45,327 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 16:00:49,859 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 16:00:51,075 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 16:01:09,368 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 16:01:09,369 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-12 16:20:33,669 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 16:20:34,260 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 16:20:34,263 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 16:20:34,267 - main - INFO - 应用启动...
2025-06-12 16:20:34,424 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 16:20:34,425 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 16:20:34,426 - main - INFO - 应用启动完成
2025-06-12 16:20:55,341 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 16:20:57,944 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 16:21:05,670 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 16:22:10,217 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 16:22:10,218 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-12 16:22:10,875 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 16:22:13,541 - websocket_manager - INFO - 关闭用户 admin 的旧连接
2025-06-12 16:22:13,542 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 16:22:13,549 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 16:22:16,850 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 16:22:17,122 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 16:22:20,660 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 16:22:26,570 - main - ERROR - 全局异常: 8 validation errors:
  {'type': 'missing', 'loc': ('response', 'id'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x00000174F31B39A0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'name'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x00000174F31B39A0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'is_private'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x00000174F31B39A0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'created_by'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x00000174F31B39A0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'creator_username'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x00000174F31B39A0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'member_count'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x00000174F31B39A0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'created_at'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x00000174F31B39A0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'updated_at'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x00000174F31B39A0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 154, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 8 validation errors:
  {'type': 'missing', 'loc': ('response', 'id'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x00000174F31B39A0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'name'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x00000174F31B39A0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'is_private'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x00000174F31B39A0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'created_by'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x00000174F31B39A0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'creator_username'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x00000174F31B39A0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'member_count'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x00000174F31B39A0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'created_at'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x00000174F31B39A0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'updated_at'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x00000174F31B39A0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}

2025-06-12 16:23:00,340 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 16:23:03,394 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 16:23:04,488 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 16:23:42,118 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 16:23:42,119 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-12 16:25:07,033 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 16:25:08,398 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 16:32:48,620 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 16:32:48,622 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-12 16:32:48,726 - main - INFO - 应用关闭...
2025-06-12 16:32:50,958 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 16:32:51,353 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 16:32:51,353 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 16:32:51,357 - main - INFO - 应用启动...
2025-06-12 16:32:51,418 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 16:32:51,418 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 16:32:51,418 - main - INFO - 应用启动完成
2025-06-12 16:32:52,296 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 16:35:11,784 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 16:35:11,891 - main - INFO - 应用关闭...
2025-06-12 16:35:14,121 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 16:35:14,529 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 16:35:14,530 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 16:35:14,533 - main - INFO - 应用启动...
2025-06-12 16:35:14,598 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 16:35:14,599 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 16:35:14,599 - main - INFO - 应用启动完成
2025-06-12 16:35:15,303 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 16:35:25,386 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 16:35:25,828 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 16:35:25,832 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 16:35:25,832 - main - INFO - 应用启动...
2025-06-12 16:35:25,894 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 16:35:25,894 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 16:35:25,894 - main - INFO - 应用启动完成
2025-06-12 16:35:28,301 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 16:37:02,336 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 16:59:52,830 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 16:59:57,692 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 17:00:01,021 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:00:16,555 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 17:00:20,431 - main - INFO - 应用关闭...
2025-06-12 17:00:35,126 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 17:00:35,608 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 17:00:35,610 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 17:00:35,614 - main - INFO - 应用启动...
2025-06-12 17:00:49,714 - auth - INFO - 用户初始化完成
2025-06-12 17:00:50,074 - auth - INFO - 权限初始化完成
2025-06-12 17:00:50,655 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 17:00:50,656 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 17:00:50,657 - main - INFO - 应用启动完成
2025-06-12 17:05:04,759 - new_app.core.file_manager - ERROR - 保存文件失败: 'G:\\cursor_projects\\extensions_web\\file_uploads\\20250612_170504_fd17d9a7_default-avatar.png' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 124, in save_file
    filepath=str(file_path.relative_to(self.upload_dir)),
  File "D:\develop\python396\lib\pathlib.py", line 929, in relative_to
    raise ValueError("{!r} is not in the subpath of {!r}"
ValueError: 'G:\\cursor_projects\\extensions_web\\file_uploads\\20250612_170504_fd17d9a7_default-avatar.png' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
2025-06-12 17:08:18,017 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:08:26,159 - main - ERROR - 全局异常: 6 validation errors:
  {'type': 'missing', 'loc': ('response', 'id'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x0000017DFBF65910>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'name'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x0000017DFBF65910>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'is_private'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x0000017DFBF65910>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'created_by'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x0000017DFBF65910>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'created_at'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x0000017DFBF65910>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'updated_at'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x0000017DFBF65910>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 154, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 6 validation errors:
  {'type': 'missing', 'loc': ('response', 'id'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x0000017DFBF65910>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'name'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x0000017DFBF65910>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'is_private'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x0000017DFBF65910>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'created_by'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x0000017DFBF65910>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'created_at'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x0000017DFBF65910>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'updated_at'), 'msg': 'Field required', 'input': {'message': '聊天室创建成功', 'room': <new_app.models.chat.ChatRoom object at 0x0000017DFBF65910>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}

2025-06-12 17:09:05,234 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 17:09:05,322 - main - INFO - 应用关闭...
2025-06-12 17:09:08,082 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 17:09:08,846 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 17:09:08,850 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 17:09:08,861 - main - INFO - 应用启动...
2025-06-12 17:09:09,009 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 17:09:09,010 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 17:09:09,011 - main - INFO - 应用启动完成
2025-06-12 17:09:09,016 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:13:17,107 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 17:13:17,211 - main - INFO - 应用关闭...
2025-06-12 17:13:19,658 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-12 17:13:20,142 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-12 17:13:20,143 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-12 17:13:20,145 - main - INFO - 应用启动...
2025-06-12 17:13:20,224 - extension_manager - INFO - 开始加载所有扩展
2025-06-12 17:13:20,225 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-12 17:13:20,225 - main - INFO - 应用启动完成
2025-06-12 17:13:20,416 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:13:25,173 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 17:13:27,355 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:13:32,108 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 17:13:34,392 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 17:13:34,888 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 17:13:35,566 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 17:13:35,960 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 17:13:37,723 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 17:13:38,417 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 17:13:56,599 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-12 17:13:57,654 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 17:16:41,938 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 17:16:41,938 - websocket_manager - INFO - 用户 admin 离开聊天室 2
2025-06-12 17:16:41,939 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-12 17:16:44,312 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:16:45,076 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-12 17:19:44,192 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 17:19:44,193 - websocket_manager - INFO - 用户 admin 离开聊天室 2
2025-06-12 17:19:44,836 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:19:47,509 - websocket_manager - INFO - 关闭用户 admin 的旧连接
2025-06-12 17:19:47,509 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:19:47,511 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 17:19:51,407 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:20:13,953 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 17:20:14,621 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:20:17,304 - websocket_manager - INFO - 关闭用户 admin 的旧连接
2025-06-12 17:20:17,305 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:20:17,309 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 17:20:21,297 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:20:23,436 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 17:20:25,864 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:22:06,509 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 17:22:07,181 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:22:10,299 - websocket_manager - INFO - 关闭用户 admin 的旧连接
2025-06-12 17:22:10,299 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:22:10,301 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 17:22:14,296 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:23:25,801 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 17:23:26,447 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:23:29,304 - websocket_manager - INFO - 关闭用户 admin 的旧连接
2025-06-12 17:23:29,305 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:23:29,307 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 17:23:33,297 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:23:47,140 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 17:23:49,872 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:23:52,449 - main - ERROR - 全局异常: 8 validation errors:
  {'type': 'missing', 'loc': ('response', 'id'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A45790>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'name'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A45790>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'is_private'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A45790>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'created_by'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A45790>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'creator_username'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A45790>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'member_count'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A45790>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'created_at'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A45790>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'updated_at'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A45790>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 154, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 8 validation errors:
  {'type': 'missing', 'loc': ('response', 'id'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A45790>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'name'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A45790>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'is_private'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A45790>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'created_by'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A45790>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'creator_username'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A45790>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'member_count'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A45790>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'created_at'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A45790>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'updated_at'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A45790>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}

2025-06-12 17:24:30,845 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 17:24:43,346 - websocket_manager - INFO - 用户 admin 已连接
2025-06-12 17:24:45,711 - main - ERROR - 全局异常: 8 validation errors:
  {'type': 'missing', 'loc': ('response', 'id'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A331C0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'name'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A331C0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'is_private'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A331C0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'created_by'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A331C0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'creator_username'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A331C0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'member_count'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A331C0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'created_at'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A331C0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'updated_at'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A331C0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 154, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 8 validation errors:
  {'type': 'missing', 'loc': ('response', 'id'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A331C0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'name'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A331C0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'is_private'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A331C0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'created_by'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A331C0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'creator_username'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A331C0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'member_count'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A331C0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'created_at'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A331C0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}
  {'type': 'missing', 'loc': ('response', 'updated_at'), 'msg': 'Field required', 'input': {'message': '聊天室更新成功', 'room': <new_app.models.chat.ChatRoom object at 0x000002DCB2A331C0>}, 'url': 'https://errors.pydantic.dev/2.3/v/missing'}

2025-06-12 17:25:03,290 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-12 17:25:09,810 - main - INFO - 应用关闭...
2025-06-14 08:08:15,298 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 08:08:16,040 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 08:08:16,099 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 08:08:16,099 - main - INFO - 应用启动...
2025-06-14 08:08:16,177 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 08:08:16,178 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 08:08:16,178 - main - INFO - 应用启动完成
2025-06-14 08:24:41,656 - main - INFO - 应用关闭...
2025-06-14 08:24:43,774 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 08:24:44,193 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 08:24:44,193 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 08:24:44,196 - main - INFO - 应用启动...
2025-06-14 08:24:44,263 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 08:24:44,269 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 08:24:44,269 - main - INFO - 应用启动完成
2025-06-14 08:31:54,685 - main - INFO - 应用关闭...
2025-06-14 08:31:56,767 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 08:31:57,114 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 08:31:57,130 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 08:31:57,130 - main - INFO - 应用启动...
2025-06-14 08:31:57,184 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 08:31:57,184 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 08:31:57,184 - main - INFO - 应用启动完成
2025-06-14 08:33:37,621 - main - INFO - 应用关闭...
2025-06-14 08:33:39,422 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 08:33:39,738 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 08:33:39,738 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 08:33:39,738 - main - INFO - 应用启动...
2025-06-14 08:33:39,807 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 08:33:39,808 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 08:33:39,808 - main - INFO - 应用启动完成
2025-06-14 08:34:45,921 - main - INFO - 应用关闭...
2025-06-14 08:34:47,684 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 08:34:48,037 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 08:34:48,037 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 08:34:48,037 - main - INFO - 应用启动...
2025-06-14 08:34:48,098 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 08:34:48,098 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 08:34:48,098 - main - INFO - 应用启动完成
2025-06-14 08:42:43,015 - main - INFO - 应用关闭...
2025-06-14 08:42:44,883 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 08:42:45,283 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 08:42:45,283 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 08:42:45,285 - main - INFO - 应用启动...
2025-06-14 08:42:45,350 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 08:42:45,350 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 08:42:45,351 - main - INFO - 应用启动完成
2025-06-14 08:43:09,339 - main - INFO - 应用关闭...
2025-06-14 08:43:11,137 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 08:43:11,489 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 08:43:11,489 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 08:43:11,489 - main - INFO - 应用启动...
2025-06-14 08:43:11,566 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 08:43:11,567 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 08:43:11,567 - main - INFO - 应用启动完成
2025-06-14 08:56:43,216 - main - INFO - 应用关闭...
2025-06-14 08:56:45,380 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 08:56:45,814 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 08:56:45,815 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 08:56:45,817 - main - INFO - 应用启动...
2025-06-14 08:58:06,983 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 08:58:07,504 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 08:58:07,504 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 08:58:07,506 - main - INFO - 应用启动...
2025-06-14 08:58:07,584 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 08:58:07,585 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 08:58:07,586 - main - INFO - 应用启动完成
2025-06-14 08:58:34,639 - main - INFO - 应用关闭...
2025-06-14 08:58:36,928 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 08:58:37,374 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 08:58:37,374 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 08:58:37,376 - main - INFO - 应用启动...
2025-06-14 08:58:37,462 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 08:58:37,463 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 08:58:37,463 - main - INFO - 应用启动完成
2025-06-14 09:06:44,619 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:06:52,704 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:06:54,383 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:06:56,413 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:07:00,222 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:07:00,223 - websocket_manager - INFO - 用户 admin 离开聊天室 2
2025-06-14 09:07:00,223 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-14 09:07:02,180 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:07:03,534 - websocket_manager - INFO - 关闭用户 admin 的旧连接
2025-06-14 09:07:03,534 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:07:03,536 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:07:06,846 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:07:11,575 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:07:14,275 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:07:26,577 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:07:26,577 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-14 09:07:26,577 - websocket_manager - INFO - 用户 admin 离开聊天室 2
2025-06-14 09:07:29,906 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:07:46,438 - websocket_manager - INFO - 关闭用户 admin 的旧连接
2025-06-14 09:07:46,438 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:07:46,440 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:07:49,746 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:08:09,444 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:08:10,323 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:08:11,488 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:08:50,806 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:08:51,390 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:08:54,277 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:08:54,825 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:10:22,572 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:10:22,573 - websocket_manager - INFO - 用户 admin 离开聊天室 2
2025-06-14 09:10:22,573 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-14 09:10:23,237 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:10:26,861 - websocket_manager - INFO - 关闭用户 admin 的旧连接
2025-06-14 09:10:26,862 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:10:26,865 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:10:30,854 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:11:20,279 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:11:20,629 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:11:23,856 - websocket_manager - INFO - 关闭用户 admin 的旧连接
2025-06-14 09:11:23,857 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:11:23,859 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:11:27,854 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:11:28,169 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:11:28,828 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:11:31,268 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:11:31,485 - websocket_manager - INFO - 关闭用户 admin 的旧连接
2025-06-14 09:11:31,486 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:11:31,487 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:11:31,488 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-14 09:11:34,799 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:11:40,471 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:12:37,436 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 09:12:43,679 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:12:56,385 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:14:18,319 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:14:18,320 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-14 09:14:18,322 - websocket_manager - ERROR - 向聊天室 2 的成员 tyy 发送消息时出错: received 1005 (no status received [internal]); then sent 1005 (no status received [internal])
2025-06-14 09:14:18,322 - websocket_manager - INFO - 用户 tyy 已断开连接
2025-06-14 09:14:18,323 - websocket_manager - INFO - 用户 tyy 离开聊天室 2
2025-06-14 09:14:18,323 - websocket_manager - INFO - 用户 admin 离开聊天室 2
2025-06-14 09:14:18,957 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 09:14:18,971 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:14:21,636 - websocket_manager - INFO - 关闭用户 tyy 的旧连接
2025-06-14 09:14:21,638 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 09:14:21,641 - websocket_manager - INFO - 用户 tyy 已断开连接
2025-06-14 09:14:21,666 - websocket_manager - INFO - 关闭用户 admin 的旧连接
2025-06-14 09:14:21,666 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:14:21,666 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:14:24,942 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 09:14:24,981 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:14:25,875 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:14:26,786 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:14:27,805 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:14:28,435 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:14:30,742 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:14:33,663 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:14:36,192 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:14:41,612 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:14:42,348 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:14:43,174 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:14:43,730 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:14:44,373 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:14:44,858 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:14:45,796 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:14:46,318 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:14:47,588 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:14:48,294 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:14:48,961 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:14:51,908 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:14:52,843 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:14:53,757 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:14:54,545 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:15:06,009 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:15:07,099 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:15:25,631 - websocket_manager - INFO - 用户 tyy 已断开连接
2025-06-14 09:15:25,632 - websocket_manager - INFO - 用户 tyy 离开聊天室 2
2025-06-14 09:15:25,632 - websocket_manager - INFO - 用户 tyy 离开聊天室 1
2025-06-14 09:15:25,683 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:15:25,684 - websocket_manager - INFO - 用户 admin 离开聊天室 2
2025-06-14 09:15:25,684 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-14 09:15:26,031 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:15:26,276 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 09:15:29,865 - websocket_manager - INFO - 关闭用户 tyy 的旧连接
2025-06-14 09:15:29,865 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 09:15:29,868 - websocket_manager - INFO - 用户 tyy 已断开连接
2025-06-14 09:15:29,869 - websocket_manager - ERROR - 向用户 admin 发送消息时出错: Cannot call "send" once a close message has been sent.
2025-06-14 09:15:29,869 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:15:29,870 - websocket_manager - INFO - 关闭用户 admin 的旧连接
2025-06-14 09:15:29,871 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:15:29,873 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:15:33,855 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 09:15:33,858 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:15:39,770 - websocket_manager - INFO - 用户 tyy 已断开连接
2025-06-14 09:15:39,824 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:15:40,135 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 09:15:40,480 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:15:43,085 - websocket_manager - INFO - 关闭用户 tyy 的旧连接
2025-06-14 09:15:43,086 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 09:15:43,090 - websocket_manager - INFO - 用户 tyy 已断开连接
2025-06-14 09:15:43,143 - websocket_manager - INFO - 关闭用户 admin 的旧连接
2025-06-14 09:15:43,144 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:15:43,145 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:15:46,410 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 09:15:46,459 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:15:47,139 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:15:50,029 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:15:51,240 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:15:53,739 - websocket_manager - INFO - 用户 tyy 已断开连接
2025-06-14 09:16:01,168 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 09:16:03,337 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:16:06,072 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:16:07,008 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:16:07,882 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:16:08,764 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:16:09,507 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:16:10,358 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:16:10,929 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:16:12,452 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:16:13,016 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:16:20,310 - websocket_manager - INFO - 用户 tyy 已断开连接
2025-06-14 09:16:20,311 - websocket_manager - INFO - 用户 tyy 离开聊天室 2
2025-06-14 09:16:20,313 - websocket_manager - INFO - 用户 tyy 离开聊天室 1
2025-06-14 09:16:20,519 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:16:20,520 - websocket_manager - INFO - 用户 admin 离开聊天室 2
2025-06-14 09:16:20,821 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 09:16:20,895 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:16:23,054 - websocket_manager - INFO - 用户 tyy 已断开连接
2025-06-14 09:16:23,836 - websocket_manager - INFO - 关闭用户 admin 的旧连接
2025-06-14 09:16:23,837 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:16:23,839 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:16:27,689 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:16:29,919 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:16:34,788 - websocket_manager - INFO - 关闭用户 admin 的旧连接
2025-06-14 09:16:34,789 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:16:34,791 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:16:34,792 - websocket_manager - INFO - 用户 admin 离开聊天室 2
2025-06-14 09:16:37,055 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:16:37,738 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:16:38,097 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:16:38,306 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:16:40,369 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:16:41,322 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:16:44,529 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:16:46,507 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:16:46,508 - websocket_manager - INFO - 用户 admin 离开聊天室 2
2025-06-14 09:16:46,508 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-14 09:16:49,821 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:16:52,195 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 09:16:54,554 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:16:56,278 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:16:57,057 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:16:57,665 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:16:58,372 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:16:58,854 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:16:59,358 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:16:59,933 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:17:00,443 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:17:02,681 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:17:03,493 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:17:04,198 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:17:04,796 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:17:13,282 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:17:13,980 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:17:19,411 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:17:19,412 - websocket_manager - INFO - 用户 admin 离开聊天室 2
2025-06-14 09:17:19,413 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-14 09:17:22,469 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:17:27,671 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:17:28,291 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:17:28,833 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:17:29,303 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:17:29,737 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:17:30,352 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:17:30,875 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:17:38,971 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:17:40,141 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:17:40,895 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:17:43,186 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:17:48,843 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:17:49,527 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:17:50,410 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:17:51,128 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:17:53,543 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 09:17:54,018 - websocket_manager - INFO - 用户 tyy 加入聊天室 2
2025-06-14 09:18:47,157 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:18:49,045 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:18:50,097 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:21:14,815 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:21:14,816 - websocket_manager - INFO - 用户 admin 离开聊天室 2
2025-06-14 09:21:14,818 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-14 09:21:17,675 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:21:20,569 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:21:21,548 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:21:24,822 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:21:24,823 - websocket_manager - INFO - 用户 admin 离开聊天室 2
2025-06-14 09:21:24,825 - websocket_manager - ERROR - 向聊天室 1 的成员 tyy 发送消息时出错: received 1001 (going away); then sent 1001 (going away)
2025-06-14 09:21:24,826 - websocket_manager - INFO - 用户 tyy 已断开连接
2025-06-14 09:21:24,827 - websocket_manager - INFO - 用户 tyy 离开聊天室 2
2025-06-14 09:21:24,827 - websocket_manager - INFO - 用户 tyy 离开聊天室 1
2025-06-14 09:21:24,828 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-14 09:21:30,791 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 09:49:21,175 - websocket_manager - INFO - 用户 tyy 已断开连接
2025-06-14 09:49:21,290 - main - INFO - 应用关闭...
2025-06-14 09:49:23,446 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 09:49:23,885 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 09:49:23,885 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 09:49:23,887 - main - INFO - 应用启动...
2025-06-14 09:49:56,536 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 09:49:56,919 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 09:49:56,920 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 09:49:56,921 - main - INFO - 应用启动...
2025-06-14 09:49:56,988 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 09:49:56,988 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 09:49:56,988 - main - INFO - 应用启动完成
2025-06-14 09:49:56,993 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:49:56,996 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 09:54:29,033 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:54:29,865 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:54:30,638 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:54:31,287 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:54:31,791 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:54:32,299 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:54:32,860 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:54:35,465 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:54:36,055 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:54:40,280 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:54:40,752 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:54:42,238 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:54:42,725 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:54:43,282 - websocket_manager - INFO - 用户 admin 加入聊天室 1
2025-06-14 09:54:44,209 - websocket_manager - INFO - 用户 admin 加入聊天室 2
2025-06-14 09:56:13,296 - websocket_manager - INFO - 用户 tyy 已断开连接
2025-06-14 09:56:16,622 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 09:56:19,060 - websocket_manager - INFO - 用户 tyy 已断开连接
2025-06-14 09:56:35,617 - new_app.core.file_manager - ERROR - 保存文件失败: 'G:\\cursor_projects\\extensions_web\\file_uploads\\20250614_095635_fd17d9a7_default-avatar.png' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 124, in save_file
    filepath=str(file_path.relative_to(self.upload_dir)),
  File "D:\develop\python396\lib\pathlib.py", line 929, in relative_to
    raise ValueError("{!r} is not in the subpath of {!r}"
ValueError: 'G:\\cursor_projects\\extensions_web\\file_uploads\\20250614_095635_fd17d9a7_default-avatar.png' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
2025-06-14 09:57:23,967 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:57:23,968 - websocket_manager - INFO - 用户 admin 离开聊天室 1
2025-06-14 09:57:23,969 - websocket_manager - INFO - 用户 admin 离开聊天室 2
2025-06-14 09:57:24,075 - main - INFO - 应用关闭...
2025-06-14 09:57:26,232 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 09:57:26,622 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 09:57:26,622 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 09:57:26,622 - main - INFO - 应用启动...
2025-06-14 09:57:26,693 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 09:57:26,693 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 09:57:26,693 - main - INFO - 应用启动完成
2025-06-14 09:57:27,868 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:57:41,833 - new_app.core.file_manager - ERROR - 保存文件失败: 'G:\\cursor_projects\\extensions_web\\file_uploads\\20250614_095741_fd17d9a7_default-avatar.png' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 125, in save_file
    filepath=str(file_path.relative_to(self.upload_dir)),
  File "D:\develop\python396\lib\pathlib.py", line 929, in relative_to
    raise ValueError("{!r} is not in the subpath of {!r}"
ValueError: 'G:\\cursor_projects\\extensions_web\\file_uploads\\20250614_095741_fd17d9a7_default-avatar.png' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
2025-06-14 09:58:49,848 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 09:58:49,941 - main - INFO - 应用关闭...
2025-06-14 09:58:54,309 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 09:58:54,709 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 09:58:54,710 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 09:58:54,712 - main - INFO - 应用启动...
2025-06-14 09:58:54,787 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 09:58:54,788 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 09:58:54,788 - main - INFO - 应用启动完成
2025-06-14 09:58:54,791 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 09:59:11,810 - new_app.core.file_manager - ERROR - 保存文件失败: 'G:\\cursor_projects\\extensions_web\\file_uploads\\20250614_095911_fd17d9a7_default-avatar.png' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 126, in save_file
    filepath=str(file_path.relative_to(self.upload_dir)),
  File "D:\develop\python396\lib\pathlib.py", line 929, in relative_to
    raise ValueError("{!r} is not in the subpath of {!r}"
ValueError: 'G:\\cursor_projects\\extensions_web\\file_uploads\\20250614_095911_fd17d9a7_default-avatar.png' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
2025-06-14 10:01:29,004 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 10:01:29,096 - main - INFO - 应用关闭...
2025-06-14 10:01:30,993 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:01:31,377 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:01:31,378 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:01:31,380 - main - INFO - 应用启动...
2025-06-14 10:01:31,509 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:01:31,532 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:01:31,537 - main - INFO - 应用启动完成
2025-06-14 10:01:32,872 - websocket_manager - INFO - 用户 admin 已连接
2025-06-14 10:01:53,252 - websocket_manager - INFO - 用户 admin 已断开连接
2025-06-14 10:02:02,523 - new_app.core.file_manager - ERROR - 保存文件失败: 'G:\\cursor_projects\\extensions_web\\file_uploads\\20250614_100202_fd17d9a7_default-avatar.png' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 126, in save_file
    filepath=str(file_path.relative_to(self.upload_dir)),
  File "D:\develop\python396\lib\pathlib.py", line 929, in relative_to
    raise ValueError("{!r} is not in the subpath of {!r}"
ValueError: 'G:\\cursor_projects\\extensions_web\\file_uploads\\20250614_100202_fd17d9a7_default-avatar.png' is not in the subpath of 'file_uploads' OR one path is relative and the other is absolute.
2025-06-14 10:03:47,845 - main - INFO - 应用关闭...
2025-06-14 10:03:49,931 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:03:50,322 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:03:50,322 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:03:50,322 - main - INFO - 应用启动...
2025-06-14 10:03:50,392 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:03:50,392 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:03:50,392 - main - INFO - 应用启动完成
2025-06-14 10:03:58,277 - new_app.core.file_manager - ERROR - 保存文件失败: 'WindowsPath' object has no attribute 'startswith'
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 103, in save_file
    if not target_dir.startswith(upload_dir):
AttributeError: 'WindowsPath' object has no attribute 'startswith'
2025-06-14 10:09:07,899 - main - INFO - 应用关闭...
2025-06-14 10:09:10,135 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:09:10,482 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:09:10,482 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:09:10,482 - main - INFO - 应用启动...
2025-06-14 10:09:10,553 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:09:10,553 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:09:10,554 - main - INFO - 应用启动完成
2025-06-14 10:09:17,927 - new_app.core.file_manager - ERROR - 保存文件失败: 非法路径
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 104, in save_file
    raise ValueError("非法路径")
ValueError: 非法路径
2025-06-14 10:10:30,222 - main - INFO - 应用关闭...
2025-06-14 10:10:32,636 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:10:33,029 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:10:33,030 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:10:33,032 - main - INFO - 应用启动...
2025-06-14 10:10:33,101 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:10:33,101 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:10:33,102 - main - INFO - 应用启动完成
2025-06-14 10:10:41,017 - new_app.core.file_manager - ERROR - 保存文件失败: 非法路径
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 104, in save_file
    raise ValueError("非法路径")
ValueError: 非法路径
2025-06-14 10:11:18,943 - main - INFO - 应用关闭...
2025-06-14 10:11:20,791 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:11:21,157 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:11:21,157 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:11:21,157 - main - INFO - 应用启动...
2025-06-14 10:11:21,221 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:11:21,221 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:11:21,221 - main - INFO - 应用启动完成
2025-06-14 10:11:36,104 - new_app.core.file_manager - ERROR - 保存文件失败: 非法路径
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 105, in save_file
    raise ValueError("非法路径")
ValueError: 非法路径
2025-06-14 10:12:09,103 - main - INFO - 应用关闭...
2025-06-14 10:12:11,269 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:12:11,648 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:12:11,652 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:12:11,652 - main - INFO - 应用启动...
2025-06-14 10:12:11,737 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:12:11,738 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:12:11,738 - main - INFO - 应用启动完成
2025-06-14 10:12:22,739 - new_app.core.file_manager - ERROR - 保存文件失败: 非法路径
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 105, in save_file
    raise ValueError("非法路径")
ValueError: 非法路径
2025-06-14 10:13:02,491 - main - INFO - 应用关闭...
2025-06-14 10:13:04,662 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:13:05,878 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:13:05,880 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:13:05,881 - main - INFO - 应用启动...
2025-06-14 10:13:05,999 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:13:06,001 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:13:06,001 - main - INFO - 应用启动完成
2025-06-14 10:13:12,622 - new_app.core.file_manager - ERROR - 保存文件失败: 'str' object has no attribute 'relative_to'
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 130, in save_file
    filepath=str(file_path.relative_to(self.upload_dir)),
AttributeError: 'str' object has no attribute 'relative_to'
2025-06-14 10:13:12,627 - main - ERROR - 全局异常: 'str' object has no attribute 'exists'
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 130, in save_file
    filepath=str(file_path.relative_to(self.upload_dir)),
AttributeError: 'str' object has no attribute 'relative_to'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 36, in upload_file
    db_file = await file_manager.save_file(
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 149, in save_file
    if 'file_path' in locals() and file_path.exists():
AttributeError: 'str' object has no attribute 'exists'
2025-06-14 10:13:40,669 - main - INFO - 应用关闭...
2025-06-14 10:13:42,702 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:13:43,161 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:13:43,162 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:13:43,164 - main - INFO - 应用启动...
2025-06-14 10:13:43,234 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:13:43,234 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:13:43,235 - main - INFO - 应用启动完成
2025-06-14 10:13:43,971 - main - INFO - 应用关闭...
2025-06-14 10:13:46,134 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:13:46,521 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:13:46,521 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:13:46,531 - main - INFO - 应用启动...
2025-06-14 10:13:46,602 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:13:46,603 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:13:46,603 - main - INFO - 应用启动完成
2025-06-14 10:13:55,518 - new_app.core.file_manager - ERROR - 保存文件失败: 非法路径
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 105, in save_file
    raise ValueError("非法路径")
ValueError: 非法路径
2025-06-14 10:14:17,788 - main - INFO - 应用关闭...
2025-06-14 10:14:20,081 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:14:20,492 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:14:20,493 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:14:20,495 - main - INFO - 应用启动...
2025-06-14 10:14:20,567 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:14:20,567 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:14:20,567 - main - INFO - 应用启动完成
2025-06-14 10:14:49,274 - main - INFO - 应用关闭...
2025-06-14 10:14:51,361 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:14:51,856 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:14:51,856 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:14:51,861 - main - INFO - 应用启动...
2025-06-14 10:14:51,929 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:14:51,930 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:14:51,930 - main - INFO - 应用启动完成
2025-06-14 10:15:01,584 - new_app.core.file_manager - ERROR - 保存文件失败: 非法路径
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 105, in save_file
    raise ValueError("非法路径")
ValueError: 非法路径
2025-06-14 10:15:27,445 - main - INFO - 应用关闭...
2025-06-14 10:15:30,901 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:15:31,830 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:15:31,831 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:15:31,833 - main - INFO - 应用启动...
2025-06-14 10:15:31,921 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:15:31,921 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:15:31,922 - main - INFO - 应用启动完成
2025-06-14 10:15:38,652 - new_app.core.file_manager - ERROR - 保存文件失败: 非法路径
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 105, in save_file
    raise ValueError("非法路径")
ValueError: 非法路径
2025-06-14 10:17:06,954 - main - INFO - 应用关闭...
2025-06-14 10:17:09,188 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:17:10,167 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:17:10,171 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:17:10,174 - main - INFO - 应用启动...
2025-06-14 10:17:10,276 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:17:10,276 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:17:10,281 - main - INFO - 应用启动完成
2025-06-14 10:17:17,090 - new_app.core.file_manager - ERROR - 保存文件失败: 'str' object has no attribute 'relative_to'
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 130, in save_file
    filepath=str(file_path.relative_to(self.upload_dir)),
AttributeError: 'str' object has no attribute 'relative_to'
2025-06-14 10:17:17,096 - main - ERROR - 全局异常: 'str' object has no attribute 'exists'
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 130, in save_file
    filepath=str(file_path.relative_to(self.upload_dir)),
AttributeError: 'str' object has no attribute 'relative_to'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 36, in upload_file
    db_file = await file_manager.save_file(
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 149, in save_file
    if 'file_path' in locals() and file_path.exists():
AttributeError: 'str' object has no attribute 'exists'
2025-06-14 10:17:58,398 - main - INFO - 应用关闭...
2025-06-14 10:18:00,677 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:18:01,607 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:18:01,608 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:18:01,609 - main - INFO - 应用启动...
2025-06-14 10:18:01,720 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:18:01,720 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:18:01,720 - main - INFO - 应用启动完成
2025-06-14 10:18:08,110 - main - ERROR - 全局异常: 'str' object has no attribute 'relative_to'
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 36, in upload_file
    db_file = await file_manager.save_file(
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 130, in save_file
    filepath=str(file_path.relative_to(self.upload_dir)),
AttributeError: 'str' object has no attribute 'relative_to'
2025-06-14 10:19:48,852 - main - INFO - 应用关闭...
2025-06-14 10:19:51,177 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:19:51,618 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:19:51,619 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:19:51,621 - main - INFO - 应用启动...
2025-06-14 10:19:51,731 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:19:51,732 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:19:51,732 - main - INFO - 应用启动完成
2025-06-14 10:20:16,533 - main - INFO - 应用关闭...
2025-06-14 10:20:18,854 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:20:19,283 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:20:19,283 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:20:19,285 - main - INFO - 应用启动...
2025-06-14 10:20:19,406 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:20:19,406 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:20:19,407 - main - INFO - 应用启动完成
2025-06-14 10:20:26,851 - main - ERROR - 全局异常: 1 validation errors:
  {'type': 'model_attributes_type', 'loc': ('response',), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': [<new_app.models.file.File object at 0x00000246BAE66610>], 'url': 'https://errors.pydantic.dev/2.3/v/model_attributes_type'}
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 154, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 1 validation errors:
  {'type': 'model_attributes_type', 'loc': ('response',), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': [<new_app.models.file.File object at 0x00000246BAE66610>], 'url': 'https://errors.pydantic.dev/2.3/v/model_attributes_type'}

2025-06-14 10:24:11,256 - main - INFO - 应用关闭...
2025-06-14 10:24:13,622 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:24:14,102 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:24:14,103 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:24:14,105 - main - INFO - 应用启动...
2025-06-14 10:24:14,195 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:24:14,195 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:24:14,196 - main - INFO - 应用启动完成
2025-06-14 10:24:21,755 - main - ERROR - 全局异常: 1 validation errors:
  {'type': 'string_type', 'loc': ('response', 0, 'metadata'), 'msg': 'Input should be a valid string', 'input': MetaData(), 'url': 'https://errors.pydantic.dev/2.3/v/string_type'}
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 154, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 1 validation errors:
  {'type': 'string_type', 'loc': ('response', 0, 'metadata'), 'msg': 'Input should be a valid string', 'input': MetaData(), 'url': 'https://errors.pydantic.dev/2.3/v/string_type'}

2025-06-14 10:26:29,012 - main - INFO - 应用关闭...
2025-06-14 10:26:31,358 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:26:31,768 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:26:31,768 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:26:31,770 - main - INFO - 应用启动...
2025-06-14 10:26:31,841 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:26:31,841 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:26:31,841 - main - INFO - 应用启动完成
2025-06-14 10:26:35,420 - main - ERROR - 全局异常: 'File' object has no attribute 'dict'
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 128, in get_files
    return [f.dict() for f in files]
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 128, in <listcomp>
    return [f.dict() for f in files]
AttributeError: 'File' object has no attribute 'dict'
2025-06-14 10:27:28,257 - main - INFO - 应用关闭...
2025-06-14 10:27:30,677 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:27:31,155 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:27:31,156 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:27:31,157 - main - INFO - 应用启动...
2025-06-14 10:27:31,226 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:27:31,226 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:27:31,226 - main - INFO - 应用启动完成
2025-06-14 10:27:36,028 - main - ERROR - 全局异常: 'File' object has no attribute 'dict'
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 129, in get_files
    return [f.dict() for f in files]
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 129, in <listcomp>
    return [f.dict() for f in files]
AttributeError: 'File' object has no attribute 'dict'
2025-06-14 10:29:56,340 - main - INFO - 应用关闭...
2025-06-14 10:32:18,006 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:32:18,445 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:32:18,446 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:32:18,449 - main - INFO - 应用启动...
2025-06-14 10:32:18,545 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:32:18,546 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:32:18,547 - main - INFO - 应用启动完成
2025-06-14 10:32:24,176 - main - ERROR - 全局异常: Unable to serialize unknown type: <class 'new_app.models.file.File'>
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 159, in serialize_response
    return field.serialize(
  File "D:\develop\python396\lib\site-packages\fastapi\_compat.py", line 147, in serialize
    return self._type_adapter.dump_python(
  File "D:\develop\python396\lib\site-packages\pydantic\type_adapter.py", line 268, in dump_python
    return self.serializer.to_python(
pydantic_core._pydantic_core.PydanticSerializationError: Unable to serialize unknown type: <class 'new_app.models.file.File'>
2025-06-14 10:33:10,880 - main - INFO - 应用关闭...
2025-06-14 10:33:12,882 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:33:13,280 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:33:13,280 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:33:13,282 - main - INFO - 应用启动...
2025-06-14 10:33:13,365 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:33:13,366 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:33:13,366 - main - INFO - 应用启动完成
2025-06-14 10:37:38,774 - main - INFO - 应用关闭...
2025-06-14 10:37:41,247 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:37:41,667 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:37:41,668 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:37:41,669 - main - INFO - 应用启动...
2025-06-14 10:37:41,733 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:37:41,734 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:37:41,734 - main - INFO - 应用启动完成
2025-06-14 10:38:07,723 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:38:08,138 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:38:08,138 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:38:08,139 - main - INFO - 应用启动...
2025-06-14 10:38:08,211 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:38:08,211 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:38:08,211 - main - INFO - 应用启动完成
2025-06-14 10:38:24,046 - main - ERROR - 全局异常: Unable to serialize unknown type: <class 'new_app.models.file.File'>
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 159, in serialize_response
    return field.serialize(
  File "D:\develop\python396\lib\site-packages\fastapi\_compat.py", line 147, in serialize
    return self._type_adapter.dump_python(
  File "D:\develop\python396\lib\site-packages\pydantic\type_adapter.py", line 268, in dump_python
    return self.serializer.to_python(
pydantic_core._pydantic_core.PydanticSerializationError: Unable to serialize unknown type: <class 'new_app.models.file.File'>
2025-06-14 10:40:25,061 - main - INFO - 应用关闭...
2025-06-14 10:40:30,222 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:40:30,547 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:40:30,548 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:40:30,549 - main - INFO - 应用启动...
2025-06-14 10:40:30,613 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:40:30,613 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:40:30,614 - main - INFO - 应用启动完成
2025-06-14 10:42:34,197 - main - INFO - 应用关闭...
2025-06-14 10:42:40,340 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:42:40,697 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:42:40,697 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:42:40,698 - main - INFO - 应用启动...
2025-06-14 10:42:40,770 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:42:40,770 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:42:40,770 - main - INFO - 应用启动完成
2025-06-14 10:42:55,558 - main - ERROR - 全局异常: Unable to serialize unknown type: <class 'new_app.models.file.File'>
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 159, in serialize_response
    return field.serialize(
  File "D:\develop\python396\lib\site-packages\fastapi\_compat.py", line 147, in serialize
    return self._type_adapter.dump_python(
  File "D:\develop\python396\lib\site-packages\pydantic\type_adapter.py", line 268, in dump_python
    return self.serializer.to_python(
pydantic_core._pydantic_core.PydanticSerializationError: Unable to serialize unknown type: <class 'new_app.models.file.File'>
2025-06-14 10:43:17,967 - main - ERROR - 全局异常: Unable to serialize unknown type: <class 'new_app.models.file.File'>
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 159, in serialize_response
    return field.serialize(
  File "D:\develop\python396\lib\site-packages\fastapi\_compat.py", line 147, in serialize
    return self._type_adapter.dump_python(
  File "D:\develop\python396\lib\site-packages\pydantic\type_adapter.py", line 268, in dump_python
    return self.serializer.to_python(
pydantic_core._pydantic_core.PydanticSerializationError: Unable to serialize unknown type: <class 'new_app.models.file.File'>
2025-06-14 10:44:44,906 - main - ERROR - 全局异常: Unable to serialize unknown type: <class 'new_app.models.file.File'>
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 159, in serialize_response
    return field.serialize(
  File "D:\develop\python396\lib\site-packages\fastapi\_compat.py", line 147, in serialize
    return self._type_adapter.dump_python(
  File "D:\develop\python396\lib\site-packages\pydantic\type_adapter.py", line 268, in dump_python
    return self.serializer.to_python(
pydantic_core._pydantic_core.PydanticSerializationError: Unable to serialize unknown type: <class 'new_app.models.file.File'>
2025-06-14 10:44:45,012 - main - INFO - 应用关闭...
2025-06-14 10:44:48,578 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:44:48,975 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:44:48,975 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:44:48,977 - main - INFO - 应用启动...
2025-06-14 10:44:49,042 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:44:49,042 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:44:49,042 - main - INFO - 应用启动完成
2025-06-14 10:44:55,928 - main - ERROR - 全局异常: 1 validation errors:
  {'type': 'string_type', 'loc': ('response', 0, 'metadata'), 'msg': 'Input should be a valid string', 'input': MetaData(), 'url': 'https://errors.pydantic.dev/2.3/v/string_type'}
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 154, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 1 validation errors:
  {'type': 'string_type', 'loc': ('response', 0, 'metadata'), 'msg': 'Input should be a valid string', 'input': MetaData(), 'url': 'https://errors.pydantic.dev/2.3/v/string_type'}

2025-06-14 10:46:25,479 - main - ERROR - 全局异常: 1 validation errors:
  {'type': 'string_type', 'loc': ('response', 0, 'metadata'), 'msg': 'Input should be a valid string', 'input': MetaData(), 'url': 'https://errors.pydantic.dev/2.3/v/string_type'}
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 154, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 1 validation errors:
  {'type': 'string_type', 'loc': ('response', 0, 'metadata'), 'msg': 'Input should be a valid string', 'input': MetaData(), 'url': 'https://errors.pydantic.dev/2.3/v/string_type'}

2025-06-14 10:46:25,573 - main - INFO - 应用关闭...
2025-06-14 10:46:29,251 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:46:29,634 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:46:29,635 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:46:29,636 - main - INFO - 应用启动...
2025-06-14 10:46:29,705 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:46:29,705 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:46:29,705 - main - INFO - 应用启动完成
2025-06-14 10:46:38,052 - main - INFO - 应用关闭...
2025-06-14 10:46:45,780 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:46:46,234 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:46:46,234 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:46:46,235 - main - INFO - 应用启动...
2025-06-14 10:46:46,340 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:46:46,341 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:46:46,341 - main - INFO - 应用启动完成
2025-06-14 10:46:47,020 - main - ERROR - 全局异常: 'coroutine' object has no attribute '_sa_instance_state'
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 130, in get_files
    file.owner = user
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\attributes.py", line 537, in __set__
    self.impl.set(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\attributes.py", line 1467, in set
    value = self.fire_replace_event(state, dict_, value, old, initiator)
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\attributes.py", line 1506, in fire_replace_event
    value = fn(
  File "D:\develop\python396\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 120, in set_
    newvalue_state = attributes.instance_state(newvalue)
AttributeError: 'coroutine' object has no attribute '_sa_instance_state'
2025-06-14 10:46:58,846 - main - INFO - 应用关闭...
2025-06-14 10:47:04,011 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:47:04,449 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:47:04,449 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:47:04,451 - main - INFO - 应用启动...
2025-06-14 10:47:04,523 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:47:04,524 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:47:04,524 - main - INFO - 应用启动完成
2025-06-14 10:47:10,367 - main - ERROR - 全局异常: 1 validation errors:
  {'type': 'string_type', 'loc': ('response', 0, 'metadata'), 'msg': 'Input should be a valid string', 'input': MetaData(), 'url': 'https://errors.pydantic.dev/2.3/v/string_type'}
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 154, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 1 validation errors:
  {'type': 'string_type', 'loc': ('response', 0, 'metadata'), 'msg': 'Input should be a valid string', 'input': MetaData(), 'url': 'https://errors.pydantic.dev/2.3/v/string_type'}

2025-06-14 10:49:59,580 - main - INFO - 应用关闭...
2025-06-14 10:50:04,158 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:50:04,515 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:50:04,515 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:50:04,516 - main - INFO - 应用启动...
2025-06-14 10:50:04,593 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:50:04,593 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:50:04,593 - main - INFO - 应用启动完成
2025-06-14 10:50:14,240 - main - ERROR - 全局异常: 1 validation errors:
  {'type': 'string_type', 'loc': ('response', 0, 'metadata'), 'msg': 'Input should be a valid string', 'input': MetaData(), 'url': 'https://errors.pydantic.dev/2.3/v/string_type'}
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 154, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 1 validation errors:
  {'type': 'string_type', 'loc': ('response', 0, 'metadata'), 'msg': 'Input should be a valid string', 'input': MetaData(), 'url': 'https://errors.pydantic.dev/2.3/v/string_type'}

2025-06-14 10:50:23,470 - main - INFO - 应用关闭...
2025-06-14 10:50:48,456 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:50:48,841 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:50:48,842 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:50:48,843 - main - INFO - 应用启动...
2025-06-14 10:50:52,904 - auth - INFO - 用户初始化完成
2025-06-14 10:50:53,074 - auth - INFO - 权限初始化完成
2025-06-14 10:50:53,263 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:50:53,264 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:50:53,264 - main - INFO - 应用启动完成
2025-06-14 10:51:13,246 - main - ERROR - 全局异常: Unable to serialize unknown type: <class 'new_app.models.file.File'>
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 159, in serialize_response
    return field.serialize(
  File "D:\develop\python396\lib\site-packages\fastapi\_compat.py", line 147, in serialize
    return self._type_adapter.dump_python(
  File "D:\develop\python396\lib\site-packages\pydantic\type_adapter.py", line 268, in dump_python
    return self.serializer.to_python(
pydantic_core._pydantic_core.PydanticSerializationError: Unable to serialize unknown type: <class 'new_app.models.file.File'>
2025-06-14 10:52:44,513 - main - INFO - 应用关闭...
2025-06-14 10:52:49,254 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:52:49,614 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:52:49,614 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:52:49,615 - main - INFO - 应用启动...
2025-06-14 10:52:49,686 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:52:49,686 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:52:49,687 - main - INFO - 应用启动完成
2025-06-14 10:52:55,394 - main - ERROR - 全局异常: 1 validation errors:
  {'type': 'string_type', 'loc': ('response', 0, 'metadata'), 'msg': 'Input should be a valid string', 'input': MetaData(), 'url': 'https://errors.pydantic.dev/2.3/v/string_type'}
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 154, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 1 validation errors:
  {'type': 'string_type', 'loc': ('response', 0, 'metadata'), 'msg': 'Input should be a valid string', 'input': MetaData(), 'url': 'https://errors.pydantic.dev/2.3/v/string_type'}

2025-06-14 10:53:32,103 - main - INFO - 应用关闭...
2025-06-14 10:53:36,703 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:53:37,030 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:53:37,030 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:53:37,031 - main - INFO - 应用启动...
2025-06-14 10:53:37,104 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:53:37,104 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:53:37,104 - main - INFO - 应用启动完成
2025-06-14 10:59:54,565 - main - INFO - 应用关闭...
2025-06-14 10:59:57,620 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 10:59:57,971 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 10:59:57,971 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 10:59:57,972 - main - INFO - 应用启动...
2025-06-14 10:59:58,034 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 10:59:58,034 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 10:59:58,035 - main - INFO - 应用启动完成
2025-06-14 11:00:07,070 - main - INFO - 应用关闭...
2025-06-14 11:00:22,639 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 11:00:28,278 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 11:00:28,623 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 11:00:28,624 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 11:00:28,625 - main - INFO - 应用启动...
2025-06-14 11:00:28,694 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 11:00:28,694 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 11:00:28,694 - main - INFO - 应用启动完成
2025-06-14 11:06:12,505 - main - INFO - 应用关闭...
2025-06-14 11:06:15,358 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 11:06:15,708 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 11:06:15,709 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 11:06:15,710 - main - INFO - 应用启动...
2025-06-14 11:06:15,780 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 11:06:15,781 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 11:06:15,781 - main - INFO - 应用启动完成
2025-06-14 11:06:27,493 - new_app.core.file_manager - ERROR - 创建目录失败: unsupported operand type(s) for +: 'WindowsPath' and 'str'
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 256, in create_dir
    target_dir = os.path.abspath(self.upload_dir + path)
TypeError: unsupported operand type(s) for +: 'WindowsPath' and 'str'
2025-06-14 11:07:09,256 - main - INFO - 应用关闭...
2025-06-14 11:07:17,119 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 11:07:17,600 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 11:07:17,600 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 11:07:17,602 - main - INFO - 应用启动...
2025-06-14 11:07:17,705 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 11:07:17,705 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 11:07:17,705 - main - INFO - 应用启动完成
2025-06-14 11:07:21,025 - new_app.core.file_manager - ERROR - 创建目录失败: unsupported operand type(s) for +: 'WindowsPath' and 'str'
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 257, in create_dir
    target_dir = os.path.abspath(self.upload_dir + path)
TypeError: unsupported operand type(s) for +: 'WindowsPath' and 'str'
2025-06-14 11:09:43,379 - main - INFO - 应用关闭...
2025-06-14 11:09:46,608 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 11:09:47,029 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 11:09:47,029 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 11:09:47,030 - main - INFO - 应用启动...
2025-06-14 11:09:47,120 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 11:09:47,120 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 11:09:47,120 - main - INFO - 应用启动完成
2025-06-14 11:09:56,717 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 11:09:57,089 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 11:09:57,089 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 11:09:57,091 - main - INFO - 应用启动...
2025-06-14 11:09:57,160 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 11:09:57,160 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 11:09:57,160 - main - INFO - 应用启动完成
2025-06-14 11:11:41,074 - main - INFO - 应用关闭...
2025-06-14 11:11:48,805 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 11:11:49,190 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 11:11:49,191 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 11:11:49,192 - main - INFO - 应用启动...
2025-06-14 11:11:49,297 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 11:11:49,297 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 11:11:49,297 - main - INFO - 应用启动完成
2025-06-14 11:12:10,432 - main - INFO - 应用关闭...
2025-06-14 11:12:15,199 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 11:12:15,826 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 11:12:15,830 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 11:12:15,832 - main - INFO - 应用启动...
2025-06-14 11:12:16,040 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 11:12:16,040 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 11:12:16,041 - main - INFO - 应用启动完成
2025-06-14 11:17:51,220 - main - INFO - 应用关闭...
2025-06-14 11:17:58,179 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 11:17:58,561 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 11:17:58,561 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 11:17:58,562 - main - INFO - 应用启动...
2025-06-14 11:17:58,635 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 11:17:58,636 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 11:17:58,636 - main - INFO - 应用启动完成
2025-06-14 11:19:01,686 - main - INFO - 应用关闭...
2025-06-14 11:19:08,156 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 11:19:08,670 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 11:19:08,670 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 11:19:08,671 - main - INFO - 应用启动...
2025-06-14 11:19:08,753 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 11:19:08,754 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 11:19:08,754 - main - INFO - 应用启动完成
2025-06-14 11:25:24,296 - main - INFO - 应用关闭...
2025-06-14 11:25:26,923 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 11:25:27,259 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 11:25:27,259 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 11:25:27,260 - main - INFO - 应用启动...
2025-06-14 11:25:27,322 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 11:25:27,322 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 11:25:27,322 - main - INFO - 应用启动完成
2025-06-14 11:34:29,081 - main - INFO - 应用关闭...
2025-06-14 11:34:33,134 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 11:34:33,484 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 11:34:33,485 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 11:34:33,485 - main - INFO - 应用启动...
2025-06-14 11:34:33,566 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 11:34:33,567 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 11:34:33,567 - main - INFO - 应用启动完成
2025-06-14 11:39:19,852 - main - INFO - 应用关闭...
2025-06-14 11:39:22,803 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 11:39:23,259 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 11:39:23,259 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 11:39:23,261 - main - INFO - 应用启动...
2025-06-14 11:39:23,347 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 11:39:23,347 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 11:39:23,347 - main - INFO - 应用启动完成
2025-06-14 11:39:49,278 - new_app.core.file_manager - ERROR - 创建目录失败: 
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 244, in create_dir
    raise HTTPException(status_code=400, detail="非法路径")
fastapi.exceptions.HTTPException
2025-06-14 11:40:18,840 - new_app.core.file_manager - ERROR - 创建目录失败: 
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 244, in create_dir
    raise HTTPException(status_code=400, detail="非法路径")
fastapi.exceptions.HTTPException
2025-06-14 11:41:01,892 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 11:41:02,373 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 11:41:02,374 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 11:41:02,375 - main - INFO - 应用启动...
2025-06-14 11:41:02,438 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 11:41:02,438 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 11:41:02,438 - main - INFO - 应用启动完成
2025-06-14 11:41:23,036 - new_app.core.file_manager - ERROR - 创建目录失败: [WinError 3] 系统找不到指定的路径。: 'G:\\cursor_projects\\extensions_web\\file_uploads\\213\\...\\213'
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 246, in create_dir
    os.makedirs(target_dir)
  File "D:\develop\python396\lib\os.py", line 215, in makedirs
    makedirs(head, exist_ok=exist_ok)
  File "D:\develop\python396\lib\os.py", line 225, in makedirs
    mkdir(name, mode)
FileNotFoundError: [WinError 3] 系统找不到指定的路径。: 'G:\\cursor_projects\\extensions_web\\file_uploads\\213\\...\\213'
2025-06-14 11:41:46,102 - main - INFO - 应用关闭...
2025-06-14 11:41:48,866 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 11:41:49,209 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 11:41:49,209 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 11:41:49,210 - main - INFO - 应用启动...
2025-06-14 11:41:49,272 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 11:41:49,272 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 11:41:49,272 - main - INFO - 应用启动完成
2025-06-14 12:00:26,810 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 12:00:27,107 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 12:00:27,107 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 12:00:27,108 - main - INFO - 应用启动...
2025-06-14 12:00:27,163 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 12:00:27,163 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 12:00:27,163 - main - INFO - 应用启动完成
2025-06-14 12:09:50,309 - main - INFO - 应用关闭...
2025-06-14 12:09:52,747 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 12:09:53,074 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 12:09:53,075 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 12:09:53,076 - main - INFO - 应用启动...
2025-06-14 12:09:53,134 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 12:09:53,135 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 12:09:53,135 - main - INFO - 应用启动完成
2025-06-14 12:10:16,458 - main - INFO - 应用关闭...
2025-06-14 12:10:21,062 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 12:10:21,361 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 12:10:21,361 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 12:10:21,362 - main - INFO - 应用启动...
2025-06-14 12:10:21,418 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 12:10:21,419 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 12:10:21,419 - main - INFO - 应用启动完成
2025-06-14 12:15:19,400 - main - INFO - 应用关闭...
2025-06-14 12:15:22,297 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 12:15:22,727 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 12:15:22,728 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 12:15:22,729 - main - INFO - 应用启动...
2025-06-14 12:15:22,864 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 12:15:22,864 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 12:15:22,864 - main - INFO - 应用启动完成
2025-06-14 12:15:23,268 - main - INFO - 应用关闭...
2025-06-14 12:15:30,627 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 12:15:31,050 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 12:15:31,051 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 12:15:31,051 - main - INFO - 应用启动...
2025-06-14 12:15:31,126 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 12:15:31,127 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 12:15:31,127 - main - INFO - 应用启动完成
2025-06-14 12:15:33,070 - main - ERROR - 全局异常: File at path file_uploads/// is not a file.
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 69, in app
    await response(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 342, in __call__
    raise RuntimeError(f"File at path {self.path} is not a file.")
RuntimeError: File at path file_uploads/// is not a file.
2025-06-14 12:22:28,624 - main - INFO - 应用关闭...
2025-06-14 12:22:35,857 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 12:22:36,337 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 12:22:36,337 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 12:22:36,338 - main - INFO - 应用启动...
2025-06-14 12:22:36,400 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 12:22:36,400 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 12:22:36,400 - main - INFO - 应用启动完成
2025-06-14 12:22:37,637 - main - ERROR - 全局异常: [Errno 13] Permission denied: 'file_uploads///'
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 83, in download_file
    file = file_manager.get_file_stream(file_path,request.query_params.get("path"))
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 194, in get_file_stream
    return open(file_path, "rb")
PermissionError: [Errno 13] Permission denied: 'file_uploads///'
2025-06-14 12:23:31,025 - main - INFO - 应用关闭...
2025-06-14 12:23:33,573 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 12:23:33,884 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 12:23:33,885 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 12:23:33,885 - main - INFO - 应用启动...
2025-06-14 12:23:33,940 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 12:23:33,940 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 12:23:33,940 - main - INFO - 应用启动完成
2025-06-14 12:23:47,872 - main - ERROR - 全局异常: [Errno 2] No such file or directory: 'file_uploads////20250614_105113_fd17d9a7_default-avatar.png'
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 83, in download_file
    file = file_manager.get_file_stream(file_path,request.query_params.get("path"))
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 194, in get_file_stream
    return open(file_path, "rb")
FileNotFoundError: [Errno 2] No such file or directory: 'file_uploads////20250614_105113_fd17d9a7_default-avatar.png'
2025-06-14 12:24:28,773 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 12:24:29,121 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 12:24:29,121 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 12:24:29,122 - main - INFO - 应用启动...
2025-06-14 12:24:29,189 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 12:24:29,189 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 12:24:29,189 - main - INFO - 应用启动完成
2025-06-14 12:24:33,477 - main - ERROR - 全局异常: [Errno 2] No such file or directory: 'G:\\cursor_projects\\extensions_web\\file_uploads\\20250614_105113_fd17d9a7_default-avatar.png'
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 83, in download_file
    file = file_manager.get_file_stream(file_path,request.query_params.get("path"))
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 194, in get_file_stream
    return open(file_path, "rb")
FileNotFoundError: [Errno 2] No such file or directory: 'G:\\cursor_projects\\extensions_web\\file_uploads\\20250614_105113_fd17d9a7_default-avatar.png'
2025-06-14 12:25:51,151 - main - ERROR - 全局异常: 1 validation errors:
  {'type': 'model_attributes_type', 'loc': ('response',), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': [<new_app.models.file.File object at 0x000001E145DB3D30>], 'url': 'https://errors.pydantic.dev/2.3/v/model_attributes_type'}
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 154, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 1 validation errors:
  {'type': 'model_attributes_type', 'loc': ('response',), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': [<new_app.models.file.File object at 0x000001E145DB3D30>], 'url': 'https://errors.pydantic.dev/2.3/v/model_attributes_type'}

2025-06-14 12:30:06,323 - main - INFO - 应用关闭...
2025-06-14 12:30:09,348 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 12:30:09,676 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 12:30:09,676 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 12:30:09,677 - main - INFO - 应用启动...
2025-06-14 12:30:09,777 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 12:30:09,777 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 12:30:09,778 - main - INFO - 应用启动完成
2025-06-14 12:30:33,428 - main - ERROR - 全局异常: 1 validation errors:
  {'type': 'model_attributes_type', 'loc': ('response',), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': [<new_app.models.file.File object at 0x0000023D741DB6D0>], 'url': 'https://errors.pydantic.dev/2.3/v/model_attributes_type'}
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 291, in app
    content = await serialize_response(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 154, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 1 validation errors:
  {'type': 'model_attributes_type', 'loc': ('response',), 'msg': 'Input should be a valid dictionary or object to extract fields from', 'input': [<new_app.models.file.File object at 0x0000023D741DB6D0>], 'url': 'https://errors.pydantic.dev/2.3/v/model_attributes_type'}

2025-06-14 12:31:30,343 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 12:31:30,670 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 12:31:30,670 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 12:31:30,671 - main - INFO - 应用启动...
2025-06-14 12:31:30,728 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 12:31:30,728 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 12:31:30,728 - main - INFO - 应用启动完成
2025-06-14 12:31:31,031 - main - INFO - 应用关闭...
2025-06-14 12:31:38,639 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 12:31:38,965 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 12:31:38,965 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 12:31:38,966 - main - INFO - 应用启动...
2025-06-14 12:31:39,034 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 12:31:39,034 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 12:31:39,034 - main - INFO - 应用启动完成
2025-06-14 12:35:47,674 - main - INFO - 应用关闭...
2025-06-14 12:35:50,319 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 12:35:50,666 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 12:35:50,667 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 12:35:50,667 - main - INFO - 应用启动...
2025-06-14 12:35:50,730 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 12:35:50,730 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 12:35:50,730 - main - INFO - 应用启动完成
2025-06-14 12:49:09,608 - main - ERROR - 全局异常: get_file() missing 1 required positional argument: 'path'
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 104, in delete_file
    file = await file_manager.get_file(file_id)
TypeError: get_file() missing 1 required positional argument: 'path'
2025-06-14 12:49:09,655 - main - INFO - 应用关闭...
2025-06-14 12:49:12,333 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 12:49:12,651 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 12:49:12,651 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 12:49:12,652 - main - INFO - 应用启动...
2025-06-14 12:49:12,721 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 12:49:12,722 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 12:49:12,722 - main - INFO - 应用启动完成
2025-06-14 12:49:29,363 - main - ERROR - 全局异常: get_file() missing 1 required positional argument: 'path'
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 104, in delete_file
    file = await file_manager.get_file(file_id)
TypeError: get_file() missing 1 required positional argument: 'path'
2025-06-14 12:49:42,596 - main - INFO - 应用关闭...
2025-06-14 12:49:45,341 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 12:49:45,693 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 12:49:45,693 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 12:49:45,694 - main - INFO - 应用启动...
2025-06-14 12:49:45,760 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 12:49:45,760 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 12:49:45,760 - main - INFO - 应用启动完成
2025-06-14 12:52:49,493 - main - INFO - 应用关闭...
2025-06-14 12:52:52,267 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 12:52:52,765 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 12:52:52,765 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 12:52:52,766 - main - INFO - 应用启动...
2025-06-14 12:52:52,838 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 12:52:52,838 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 12:52:52,838 - main - INFO - 应用启动完成
2025-06-14 13:13:06,403 - main - INFO - 应用关闭...
2025-06-14 13:13:09,064 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 13:13:09,439 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 13:13:09,439 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 13:13:09,440 - main - INFO - 应用启动...
2025-06-14 13:13:09,504 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 13:13:09,504 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 13:13:09,504 - main - INFO - 应用启动完成
2025-06-14 13:14:30,440 - main - INFO - 应用关闭...
2025-06-14 13:14:35,797 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 13:14:36,140 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 13:14:36,140 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 13:14:36,141 - main - INFO - 应用启动...
2025-06-14 13:14:36,206 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 13:14:36,206 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 13:14:36,206 - main - INFO - 应用启动完成
2025-06-14 13:15:24,257 - main - INFO - 应用关闭...
2025-06-14 13:15:29,514 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 13:15:29,860 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 13:15:29,860 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 13:15:29,861 - main - INFO - 应用启动...
2025-06-14 13:15:29,932 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 13:15:29,932 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 13:15:29,932 - main - INFO - 应用启动完成
2025-06-14 13:15:53,710 - main - INFO - 应用关闭...
2025-06-14 13:15:59,779 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 13:16:00,074 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 13:16:00,074 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 13:16:00,075 - main - INFO - 应用启动...
2025-06-14 13:16:00,129 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 13:16:00,130 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 13:16:00,130 - main - INFO - 应用启动完成
2025-06-14 13:21:59,589 - main - INFO - 应用关闭...
2025-06-14 13:22:03,865 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 13:22:04,204 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 13:22:04,205 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 13:22:04,205 - main - INFO - 应用启动...
2025-06-14 13:22:04,266 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 13:22:04,266 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 13:22:04,266 - main - INFO - 应用启动完成
2025-06-14 13:26:29,664 - main - INFO - 应用关闭...
2025-06-14 13:26:32,843 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 13:26:33,135 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 13:26:33,135 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 13:26:33,136 - main - INFO - 应用启动...
2025-06-14 13:26:33,191 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 13:26:33,191 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 13:26:33,191 - main - INFO - 应用启动完成
2025-06-14 13:29:07,034 - main - INFO - 应用关闭...
2025-06-14 13:29:12,538 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 13:29:12,912 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 13:29:12,913 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 13:29:12,915 - main - INFO - 应用启动...
2025-06-14 13:29:13,011 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 13:29:13,012 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 13:29:13,012 - main - INFO - 应用启动完成
2025-06-14 13:33:19,902 - main - INFO - 应用关闭...
2025-06-14 13:33:23,251 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 13:33:23,659 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 13:33:23,659 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 13:33:23,661 - main - INFO - 应用启动...
2025-06-14 13:33:23,719 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 13:33:23,720 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 13:33:23,720 - main - INFO - 应用启动完成
2025-06-14 13:33:33,180 - main - INFO - 应用关闭...
2025-06-14 13:33:39,638 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 13:33:40,043 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 13:33:40,043 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 13:33:40,044 - main - INFO - 应用启动...
2025-06-14 13:33:40,117 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 13:33:40,117 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 13:33:40,117 - main - INFO - 应用启动完成
2025-06-14 13:35:31,742 - main - INFO - 应用关闭...
2025-06-14 13:35:37,300 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 13:35:37,645 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 13:35:37,645 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 13:35:37,646 - main - INFO - 应用启动...
2025-06-14 13:35:37,704 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 13:35:37,704 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 13:35:37,704 - main - INFO - 应用启动完成
2025-06-14 13:38:28,596 - main - INFO - 应用关闭...
2025-06-14 13:38:31,223 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 13:38:31,566 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 13:38:31,566 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 13:38:31,567 - main - INFO - 应用启动...
2025-06-14 13:38:31,630 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 13:38:31,630 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 13:38:31,630 - main - INFO - 应用启动完成
2025-06-14 13:38:36,318 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 13:38:36,812 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 13:38:36,812 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 13:38:36,813 - main - INFO - 应用启动...
2025-06-14 13:38:36,884 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 13:38:36,885 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 13:38:36,885 - main - INFO - 应用启动完成
2025-06-14 13:40:31,025 - main - ERROR - 全局异常: [Errno 13] Permission denied: 'G:\\cursor_projects\\extensions_web\\file_uploads\\123'
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 69, in app
    await response(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 277, in __call__
    await wrap(partial(self.listen_for_disconnect, receive))
  File "D:\develop\python396\lib\site-packages\anyio\_backends\_asyncio.py", line 597, in __aexit__
    raise exceptions[0]
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 273, in wrap
    await func()
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 262, in stream_response
    async for chunk in self.body_iterator:
  File "D:\develop\python396\lib\site-packages\starlette\concurrency.py", line 63, in iterate_in_threadpool
    yield await anyio.to_thread.run_sync(_next, iterator)
  File "D:\develop\python396\lib\site-packages\anyio\to_thread.py", line 33, in run_sync
    return await get_asynclib().run_sync_in_worker_thread(
  File "D:\develop\python396\lib\site-packages\anyio\_backends\_asyncio.py", line 877, in run_sync_in_worker_thread
    return await future
  File "D:\develop\python396\lib\site-packages\anyio\_backends\_asyncio.py", line 807, in run
    result = context.run(func, *args)
  File "D:\develop\python396\lib\site-packages\starlette\concurrency.py", line 53, in _next
    return next(iterator)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 88, in file_stream
    with open(file_path, "rb") as f:
PermissionError: [Errno 13] Permission denied: 'G:\\cursor_projects\\extensions_web\\file_uploads\\123'
2025-06-14 14:09:03,784 - main - INFO - 应用关闭...
2025-06-14 14:09:34,016 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 14:09:34,507 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 14:09:34,507 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 14:09:34,508 - main - INFO - 应用启动...
2025-06-14 14:09:38,631 - auth - INFO - 用户初始化完成
2025-06-14 14:09:38,811 - auth - INFO - 权限初始化完成
2025-06-14 14:09:38,939 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 14:09:38,939 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 14:09:38,939 - main - INFO - 应用启动完成
2025-06-14 14:32:18,104 - main - INFO - 应用关闭...
2025-06-14 14:32:34,509 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 14:32:34,947 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 14:32:34,947 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 14:32:34,949 - main - INFO - 应用启动...
2025-06-14 14:32:35,035 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 14:32:35,036 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 14:32:35,036 - main - INFO - 应用启动完成
2025-06-14 14:35:06,325 - main - INFO - 应用关闭...
2025-06-14 14:35:09,016 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 14:35:09,366 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 14:35:09,366 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 14:35:09,367 - main - INFO - 应用启动...
2025-06-14 14:35:09,432 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 14:35:09,432 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 14:35:09,432 - main - INFO - 应用启动完成
2025-06-14 14:38:45,938 - main - INFO - 应用关闭...
2025-06-14 14:38:48,661 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 14:38:49,018 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 14:38:49,019 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 14:38:49,020 - main - INFO - 应用启动...
2025-06-14 14:38:49,091 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 14:38:49,092 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 14:38:49,092 - main - INFO - 应用启动完成
2025-06-14 14:50:56,053 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 14:50:56,419 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 14:50:56,419 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 14:50:56,420 - main - INFO - 应用启动...
2025-06-14 14:50:56,492 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 14:50:56,492 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 14:50:56,493 - main - INFO - 应用启动完成
2025-06-14 14:56:43,876 - main - INFO - 应用关闭...
2025-06-14 14:56:46,720 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 14:56:47,034 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 14:56:47,034 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 14:56:47,035 - main - INFO - 应用启动...
2025-06-14 14:56:47,107 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 14:56:47,107 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 14:56:47,107 - main - INFO - 应用启动完成
2025-06-14 14:59:40,645 - main - INFO - 应用关闭...
2025-06-14 14:59:43,455 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 14:59:43,824 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 14:59:43,824 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 14:59:43,825 - main - INFO - 应用启动...
2025-06-14 14:59:43,906 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 14:59:43,906 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 14:59:43,906 - main - INFO - 应用启动完成
2025-06-14 14:59:54,572 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 14:59:55,047 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 14:59:55,047 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 14:59:55,049 - main - INFO - 应用启动...
2025-06-14 14:59:55,120 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 14:59:55,120 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 14:59:55,120 - main - INFO - 应用启动完成
2025-06-14 15:03:07,131 - main - INFO - 应用关闭...
2025-06-14 15:03:11,785 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:03:12,157 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:03:12,157 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:03:12,158 - main - INFO - 应用启动...
2025-06-14 15:03:12,230 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:03:12,230 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:03:12,230 - main - INFO - 应用启动完成
2025-06-14 15:05:02,777 - main - INFO - 应用关闭...
2025-06-14 15:05:05,496 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:05:09,818 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:05:10,164 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:05:10,165 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:05:10,166 - main - INFO - 应用启动...
2025-06-14 15:05:10,229 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:05:10,229 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:05:10,229 - main - INFO - 应用启动完成
2025-06-14 15:08:08,422 - main - INFO - 应用关闭...
2025-06-14 15:08:11,502 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:08:11,867 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:08:11,868 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:08:11,869 - main - INFO - 应用启动...
2025-06-14 15:08:11,956 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:08:11,956 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:08:11,956 - main - INFO - 应用启动完成
2025-06-14 15:08:15,237 - main - INFO - 应用关闭...
2025-06-14 15:08:19,956 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:08:20,322 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:08:20,323 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:08:20,324 - main - INFO - 应用启动...
2025-06-14 15:08:20,389 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:08:20,389 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:08:20,389 - main - INFO - 应用启动完成
2025-06-14 15:10:02,689 - main - INFO - 应用关闭...
2025-06-14 15:10:05,498 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:10:05,899 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:10:05,899 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:10:05,901 - main - INFO - 应用启动...
2025-06-14 15:10:05,981 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:10:05,981 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:10:05,981 - main - INFO - 应用启动完成
2025-06-14 15:10:43,553 - main - ERROR - 全局异常: 'latin-1' codec can't encode characters in position 54-55: ordinal not in range(256)
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 91, in download_file
    return StreamingResponse(file_stream(), media_type='application/octet-stream',headers={"Content-Disposition": f"attachment; filename={file.filename}"})
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 246, in __init__
    self.init_headers(headers)
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 73, in init_headers
    raw_headers = [
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 74, in <listcomp>
    (k.lower().encode("latin-1"), v.encode("latin-1"))
UnicodeEncodeError: 'latin-1' codec can't encode characters in position 54-55: ordinal not in range(256)
2025-06-14 15:10:52,502 - main - ERROR - 全局异常: 'latin-1' codec can't encode characters in position 54-55: ordinal not in range(256)
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 91, in download_file
    return StreamingResponse(file_stream(), media_type='application/octet-stream',headers={"Content-Disposition": f"attachment; filename={file.filename}"})
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 246, in __init__
    self.init_headers(headers)
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 73, in init_headers
    raw_headers = [
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 74, in <listcomp>
    (k.lower().encode("latin-1"), v.encode("latin-1"))
UnicodeEncodeError: 'latin-1' codec can't encode characters in position 54-55: ordinal not in range(256)
2025-06-14 15:10:54,945 - main - ERROR - 全局异常: 'latin-1' codec can't encode characters in position 54-55: ordinal not in range(256)
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 91, in download_file
    return StreamingResponse(file_stream(), media_type='application/octet-stream',headers={"Content-Disposition": f"attachment; filename={file.filename}"})
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 246, in __init__
    self.init_headers(headers)
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 73, in init_headers
    raw_headers = [
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 74, in <listcomp>
    (k.lower().encode("latin-1"), v.encode("latin-1"))
UnicodeEncodeError: 'latin-1' codec can't encode characters in position 54-55: ordinal not in range(256)
2025-06-14 15:11:04,176 - main - ERROR - 全局异常: 'latin-1' codec can't encode characters in position 54-55: ordinal not in range(256)
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 91, in download_file
    return StreamingResponse(file_stream(), media_type='application/octet-stream',headers={"Content-Disposition": f"attachment; filename={file.filename}"})
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 246, in __init__
    self.init_headers(headers)
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 73, in init_headers
    raw_headers = [
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 74, in <listcomp>
    (k.lower().encode("latin-1"), v.encode("latin-1"))
UnicodeEncodeError: 'latin-1' codec can't encode characters in position 54-55: ordinal not in range(256)
2025-06-14 15:11:10,969 - main - ERROR - 全局异常: 'latin-1' codec can't encode characters in position 54-55: ordinal not in range(256)
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 91, in download_file
    return StreamingResponse(file_stream(), media_type='application/octet-stream',headers={"Content-Disposition": f"attachment; filename={file.filename}"})
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 246, in __init__
    self.init_headers(headers)
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 73, in init_headers
    raw_headers = [
  File "D:\develop\python396\lib\site-packages\starlette\responses.py", line 74, in <listcomp>
    (k.lower().encode("latin-1"), v.encode("latin-1"))
UnicodeEncodeError: 'latin-1' codec can't encode characters in position 54-55: ordinal not in range(256)
2025-06-14 15:12:08,261 - main - INFO - 应用关闭...
2025-06-14 15:12:11,768 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:12:12,106 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:12:12,106 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:12:12,107 - main - INFO - 应用启动...
2025-06-14 15:12:12,169 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:12:12,169 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:12:12,169 - main - INFO - 应用启动完成
2025-06-14 15:17:23,799 - main - INFO - 应用关闭...
2025-06-14 15:17:32,187 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:17:32,664 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:17:32,664 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:17:32,665 - main - INFO - 应用启动...
2025-06-14 15:17:32,745 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:17:32,746 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:17:32,746 - main - INFO - 应用启动完成
2025-06-14 15:18:36,583 - main - INFO - 应用关闭...
2025-06-14 15:18:43,026 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:18:43,450 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:18:43,450 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:18:43,452 - main - INFO - 应用启动...
2025-06-14 15:18:43,521 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:18:43,521 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:18:43,521 - main - INFO - 应用启动完成
2025-06-14 15:23:38,187 - main - INFO - 应用关闭...
2025-06-14 15:23:40,918 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:23:41,358 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:23:41,358 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:23:41,360 - main - INFO - 应用启动...
2025-06-14 15:23:48,228 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:23:48,573 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:23:48,573 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:23:48,575 - main - INFO - 应用启动...
2025-06-14 15:24:18,031 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:24:18,402 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:24:18,403 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:24:18,405 - main - INFO - 应用启动...
2025-06-14 15:24:18,466 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:24:18,467 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:24:18,467 - main - INFO - 应用启动完成
2025-06-14 15:24:26,108 - main - INFO - 应用关闭...
2025-06-14 15:24:35,263 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:24:35,796 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:24:35,796 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:24:35,798 - main - INFO - 应用启动...
2025-06-14 15:24:35,904 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:24:35,905 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:24:35,905 - main - INFO - 应用启动完成
2025-06-14 15:27:44,898 - main - INFO - 应用关闭...
2025-06-14 15:27:47,966 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:27:48,334 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:27:48,334 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:27:48,336 - main - INFO - 应用启动...
2025-06-14 15:27:48,408 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:27:48,408 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:27:48,408 - main - INFO - 应用启动完成
2025-06-14 15:27:52,332 - main - INFO - 应用关闭...
2025-06-14 15:27:56,771 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:27:57,139 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:27:57,139 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:27:57,140 - main - INFO - 应用启动...
2025-06-14 15:27:57,225 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:27:57,225 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:27:57,226 - main - INFO - 应用启动完成
2025-06-14 15:28:03,912 - new_app.core.file_manager - ERROR - 删除目录失败: 'coroutine' object has no attribute 'where'
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 275, in delete_dir
    await self.db.delete(File).where(File.filepath.startswith(path))
AttributeError: 'coroutine' object has no attribute 'where'
2025-06-14 15:29:53,684 - main - INFO - 应用关闭...
2025-06-14 15:29:56,826 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:29:57,246 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:29:57,246 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:29:57,247 - main - INFO - 应用启动...
2025-06-14 15:29:57,320 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:29:57,320 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:29:57,320 - main - INFO - 应用启动完成
2025-06-14 15:30:02,409 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:30:02,784 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:30:02,784 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:30:02,785 - main - INFO - 应用启动...
2025-06-14 15:30:02,850 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:30:02,850 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:30:02,850 - main - INFO - 应用启动完成
2025-06-14 15:31:57,302 - main - INFO - 应用关闭...
2025-06-14 15:32:00,131 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:32:00,471 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:32:00,472 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:32:00,473 - main - INFO - 应用启动...
2025-06-14 15:32:00,545 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:32:00,545 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:32:00,545 - main - INFO - 应用启动完成
2025-06-14 15:32:06,892 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:32:07,299 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:32:07,299 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:32:07,300 - main - INFO - 应用启动...
2025-06-14 15:32:07,363 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:32:07,363 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:32:07,363 - main - INFO - 应用启动完成
2025-06-14 15:33:09,472 - main - INFO - 应用关闭...
2025-06-14 15:33:14,626 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:33:15,539 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:33:15,539 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:33:15,541 - main - INFO - 应用启动...
2025-06-14 15:33:15,699 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:33:15,699 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:33:15,699 - main - INFO - 应用启动完成
2025-06-14 15:33:19,426 - main - ERROR - 全局异常: No active exception to reraise
Traceback (most recent call last):
  File "D:\develop\python396\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 79, in __call__
    raise exc
  File "D:\develop\python396\lib\site-packages\starlette\middleware\exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 20, in __call__
    raise e
  File "D:\develop\python396\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "D:\develop\python396\lib\site-packages\starlette\routing.py", line 66, in app
    response = await func(request)
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 273, in app
    raw_response = await run_endpoint_function(
  File "D:\develop\python396\lib\site-packages\fastapi\routing.py", line 190, in run_endpoint_function
    return await dependant.call(**values)
  File "G:\cursor_projects\extensions_web\new_app\api\v1\endpoints\files.py", line 193, in delete_dir
    raise
RuntimeError: No active exception to reraise
2025-06-14 15:34:42,473 - main - INFO - 应用关闭...
2025-06-14 15:34:48,513 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:34:48,848 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:34:48,848 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:34:48,849 - main - INFO - 应用启动...
2025-06-14 15:34:48,913 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:34:48,913 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:34:48,913 - main - INFO - 应用启动完成
2025-06-14 15:34:56,444 - new_app.core.file_manager - ERROR - 删除目录失败: [WinError 3] 系统找不到指定的路径。: 'G:\\cursor_projects\\extensions_web\\file_uploads\\sad'
Traceback (most recent call last):
  File "G:\cursor_projects\extensions_web\new_app\core\file_manager.py", line 271, in delete_dir
    shutil.rmtree(target_dir)
  File "D:\develop\python396\lib\shutil.py", line 740, in rmtree
    return _rmtree_unsafe(path, onerror)
  File "D:\develop\python396\lib\shutil.py", line 599, in _rmtree_unsafe
    onerror(os.scandir, path, sys.exc_info())
  File "D:\develop\python396\lib\shutil.py", line 596, in _rmtree_unsafe
    with os.scandir(path) as scandir_it:
FileNotFoundError: [WinError 3] 系统找不到指定的路径。: 'G:\\cursor_projects\\extensions_web\\file_uploads\\sad'
2025-06-14 15:35:56,572 - main - INFO - 应用关闭...
2025-06-14 15:36:02,887 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:36:03,492 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:36:03,493 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:36:03,494 - main - INFO - 应用启动...
2025-06-14 15:36:03,568 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:36:03,569 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:36:03,569 - main - INFO - 应用启动完成
2025-06-14 15:38:16,304 - main - INFO - 应用关闭...
2025-06-14 15:38:19,451 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:38:19,893 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:38:19,893 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:38:19,894 - main - INFO - 应用启动...
2025-06-14 15:38:19,979 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:38:19,979 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:38:19,979 - main - INFO - 应用启动完成
2025-06-14 15:39:25,064 - main - INFO - 应用关闭...
2025-06-14 15:39:29,468 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:39:29,793 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:39:29,793 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:39:29,794 - main - INFO - 应用启动...
2025-06-14 15:39:29,871 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:39:29,871 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:39:29,871 - main - INFO - 应用启动完成
2025-06-14 15:39:43,757 - main - INFO - 应用关闭...
2025-06-14 15:39:50,035 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 15:39:50,487 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 15:39:50,487 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 15:39:50,488 - main - INFO - 应用启动...
2025-06-14 15:39:50,559 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 15:39:50,560 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 15:39:50,560 - main - INFO - 应用启动完成
2025-06-14 16:28:02,442 - main - INFO - 应用关闭...
2025-06-14 16:30:15,899 - db_manager - INFO - 数据库管理器初始化完成，数据库路径：new_app/data/app.db，数据库类型：sqlite
2025-06-14 16:30:16,295 - extension_file_manager - INFO - 扩展程序文件管理器初始化完成，基础目录：extensions\files
2025-06-14 16:30:16,295 - extension_manager - INFO - 扩展管理器初始化完成。扩展目录: extensions
2025-06-14 16:30:16,296 - main - INFO - 应用启动...
2025-06-14 16:30:16,372 - extension_manager - INFO - 开始加载所有扩展
2025-06-14 16:30:16,372 - extension_manager - INFO - 完成加载所有扩展，共 0 个
2025-06-14 16:30:16,372 - main - INFO - 应用启动完成
2025-06-14 16:41:32,308 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 16:41:36,979 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 16:41:39,493 - websocket_manager - INFO - 用户 tyy 加入聊天室 1
2025-06-14 16:43:14,287 - websocket_manager - INFO - 用户 tyy 已断开连接
2025-06-14 16:43:14,287 - websocket_manager - INFO - 用户 tyy 离开聊天室 1
2025-06-14 16:43:17,476 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 16:43:20,578 - websocket_manager - INFO - 用户 tyy 已断开连接
2025-06-14 16:43:23,894 - websocket_manager - INFO - 用户 tyy 已连接
2025-06-14 17:10:51,735 - auth - ERROR - 注册用户时发生错误: 'role' is an invalid keyword argument for User
2025-06-14 17:11:34,385 - auth - ERROR - 注册用户时发生错误: 'role' is an invalid keyword argument for User
2025-06-14 17:11:45,424 - websocket_manager - INFO - 用户 tyy 已断开连接
2025-06-14 17:11:45,529 - main - INFO - 应用关闭...
2025-06-14 17:30:32,971 - auth - INFO - 用户注册成功: asd
2025-06-14 17:32:02,854 - auth - WARNING - 用户登录失败: asd - 无效凭证
2025-06-14 17:32:06,562 - auth - WARNING - 用户登录失败: asd - 无效凭证
2025-06-14 17:32:11,164 - auth - WARNING - 用户登录失败: asd - 无效凭证
2025-06-14 17:33:31,921 - auth - INFO - 用户登录成功: admin
2025-06-14 17:33:38,738 - auth - INFO - 用户登录成功: tyy
2025-06-14 17:33:40,774 - auth - INFO - 用户登录成功: tyy
2025-06-14 17:33:43,407 - auth - INFO - 用户登录成功: tyy
2025-06-14 17:37:17,343 - auth - INFO - 用户登录成功: tyy
2025-06-14 17:37:41,354 - auth - INFO - 用户登录成功: tyy
2025-06-14 17:38:51,215 - auth - INFO - 用户登录成功: tyy
2025-06-14 17:42:10,790 - auth - INFO - 用户登录成功: tyy
2025-06-14 17:44:38,545 - auth - INFO - 用户登录成功: tyy
2025-06-14 17:44:58,047 - auth - INFO - 用户登录成功: tyy
2025-06-14 17:45:21,889 - auth - INFO - 用户登录成功: tyy
2025-06-14 17:46:04,178 - auth - INFO - 用户登录成功: tyy
2025-06-14 17:47:36,920 - auth - INFO - 用户登录成功: tyy
2025-06-14 17:49:06,521 - auth - INFO - 用户登录成功: tyy
2025-06-14 17:49:09,782 - auth - INFO - 用户登录成功: tyy
2025-06-14 17:55:50,599 - auth - INFO - 用户登录成功: tyy
2025-06-14 17:55:59,504 - auth - INFO - 用户登录成功: tyy
2025-06-14 17:56:04,413 - auth - INFO - 用户登录成功: tyy
2025-06-14 17:56:18,041 - auth - INFO - 用户登录成功: tyy
2025-06-14 17:56:35,796 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:02:17,950 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:02:44,094 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:02:51,399 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:04:02,173 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:05:03,022 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:18:02,376 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:21:17,738 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:22:21,454 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:22:26,574 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:25:05,950 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:25:48,813 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:26:36,750 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:29:55,286 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:29:57,258 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:30:51,134 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:32:17,550 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:37:43,754 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:40:50,379 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:42:42,804 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:43:49,979 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:44:32,658 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:48:49,666 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:50:49,863 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:55:35,656 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:55:42,519 - auth - INFO - 用户登录成功: tyy
2025-06-14 18:58:36,675 - auth - INFO - 用户登录成功: tyy
2025-06-14 19:01:12,699 - auth - INFO - 用户登录成功: tyy
2025-06-14 19:03:03,315 - auth - INFO - 用户登录成功: tyy
2025-06-14 19:04:34,154 - auth - INFO - 用户登录成功: tyy
2025-06-14 19:06:25,978 - auth - INFO - 用户登录成功: tyy
2025-06-14 19:08:29,252 - auth - INFO - 用户登录成功: tyy
2025-06-14 19:10:04,094 - auth - INFO - 用户登录成功: tyy
2025-06-14 19:10:17,595 - auth - INFO - 用户登录成功: tyy
2025-06-14 19:21:16,929 - auth - INFO - 用户登录成功: tyy
2025-06-14 19:22:39,140 - auth - INFO - 用户登录成功: tyy
2025-06-14 19:22:43,919 - auth - INFO - 用户登录成功: tyy
2025-06-14 19:42:15,051 - auth - INFO - 用户登录成功: tyy
2025-06-14 19:52:49,844 - auth - INFO - 用户登录成功: tyy
2025-06-14 20:01:27,088 - auth - INFO - 用户登录成功: tyy
2025-06-14 20:05:22,734 - auth - INFO - 用户登录成功: tyy
2025-06-14 20:05:39,149 - auth - INFO - 用户登录成功: tyy
2025-06-14 22:33:35,148 - auth - INFO - 用户初始化完成
2025-06-14 22:33:35,352 - auth - INFO - 权限初始化完成
2025-06-14 22:33:44,694 - auth - INFO - 用户登录成功: tyy
2025-06-14 22:35:49,676 - auth - INFO - 用户登录成功: tyy
2025-06-14 22:38:35,016 - auth - INFO - 用户登录成功: tyy
2025-06-14 22:43:52,777 - auth - INFO - 用户登录成功: tyy
2025-06-14 22:44:22,959 - auth - INFO - 用户登录成功: tyy
2025-06-14 22:54:05,124 - auth - INFO - 用户登录成功: tyy
2025-06-14 22:54:17,081 - auth - INFO - 用户登录成功: tyy
2025-06-14 23:12:07,053 - auth - INFO - 用户登录成功: tyy
2025-06-14 23:14:40,209 - auth - INFO - 用户登录成功: tyy
2025-06-15 15:37:22,902 - auth - INFO - 用户初始化完成
2025-06-15 15:37:23,089 - auth - INFO - 权限初始化完成
2025-06-15 15:41:39,200 - auth - INFO - 用户登录成功: tyy
2025-06-15 15:44:31,153 - auth - INFO - 用户登录成功: tyy
2025-06-15 15:52:33,388 - auth - INFO - 用户登录成功: tyy
2025-06-15 16:20:47,822 - auth - INFO - 用户登录成功: tyy
2025-06-15 16:21:47,787 - auth - INFO - 用户初始化完成
2025-06-15 16:21:47,951 - auth - INFO - 权限初始化完成
2025-06-15 16:21:48,714 - auth - INFO - 用户登录成功: tyy
2025-06-15 16:24:13,596 - auth - INFO - 用户登录成功: tyy
2025-06-15 16:26:56,983 - auth - INFO - 用户登录成功: tyy
2025-06-15 16:38:08,260 - auth - INFO - 用户登录成功: tyy
2025-06-15 21:34:25,570 - auth - INFO - 用户登录成功: tyy
2025-06-15 21:41:23,249 - auth - INFO - 用户登录成功: tyy
2025-06-15 21:42:11,287 - auth - INFO - 用户登录成功: tyy
2025-06-15 21:42:58,706 - auth - INFO - 用户登录成功: tyy
2025-06-15 21:46:20,954 - auth - INFO - 用户登录成功: tyy
2025-06-15 21:50:07,605 - auth - INFO - 用户登录成功: tyy
2025-06-15 21:54:50,489 - auth - INFO - 用户登录成功: tyy
2025-06-15 21:58:21,703 - auth - INFO - 用户登录成功: tyy
2025-06-15 22:00:08,634 - auth - INFO - 用户登录成功: tyy
2025-06-15 22:01:07,102 - auth - INFO - 用户登录成功: tyy
2025-06-15 22:03:37,630 - auth - INFO - 用户登录成功: tyy
2025-06-15 22:11:07,120 - auth - INFO - 用户登录成功: tyy
2025-06-15 22:25:37,810 - auth - INFO - 用户登录成功: tyy
2025-06-15 22:27:52,965 - auth - INFO - 用户登录成功: tyy
2025-06-15 22:28:55,231 - auth - INFO - 用户登录成功: tyy
2025-06-15 22:29:01,260 - auth - INFO - 用户登录成功: tyy
